% /*!
%  *  @brief     This script is used to test the DoaEstimationMusicSignalImplement for code generation.
%  *  @details  . 
%  *  @pre       .
%  *  @bug      Null
%  *  @warning  Null
%  *  @author    Collus Wang
%  *  @version   1.0
%  *  @date      2017.10.17
%  *  @copyright Collus Wang all rights reserved.
%  * @remark   { revision history: V1.0 2017.10.18. Collus Wang, first draft }
%  * @remark   { revision history: V1.1 2017.10.20. Collus Wang, 1. make sure the working folder is current m-file folder. 2. check mex result 3. use anitInterMuisc instead of Music.}
%  */

%% clear
clear all %#ok<CLALL>
close all
clc
% make sure the working folder is current m-file folder.
filePath= mfilename('fullpath');
idx=strfind(filePath,'\');
CurrentDirectory=filePath(1:idx(end));
cd(CurrentDirectory)
addpath(CurrentDirectory)
cd('..\..')
ScriptCall = true;
FlagCompareMex = true;

testTargetAngleRange = [(-20:20); zeros(1,41)];
for idxAngle = 1:size(testTargetAngleRange,2)
    
    %% prepare
    sysPara = GenSysPara();                         %% Gen. System para.
    sysPara.FlagAnalyzeWaveform = false;
    sysPara.FlagBeamforming = false;
    
    sysPara.TargetSigType = 'CustomPilot';     % string. target singal type. valid value = {'QPSK', '16QAM', '64QAM', 'CustomPilot'}
    sysPara.NumTarget = 1;              % interger scaler. number of target
    sysPara.TargetAngle = testTargetAngleRange(:,idxAngle);      % double 2xN matrix. incoming wave direction in degree, [azimuth; elevation]. Each column represents one target.

    
    sysPara.SwitchAWGN = true;          % boolen scaler. switch flag of AWGN.  true = add noise; false = not add noise.
    sysPara.SNR = 20;                   % double scaler. SNR, in dB, in-channel SNR. Valid only when SwitchAWGN = true.
    
    sysPara.SwitchInterence = false;    % boolen scaler. true = enable interference; false = disable interference.
    sysPara.DoaEstimator = 'AntiInterMUSIC';     % string. DOA estimator type. valid value = {'ToolboxMusicEstimator2D', 'CBF', 'MUSIC', 'AntiInterMUSIC'}
    % 'ToolboxMusicEstimator2D' = using system toolbox for music estimator.
    % 'CBF' = Conventional Beamforming DOA
    % 'MUSIC' = MUSIC without interference suppression feature.
    % 'AntiInterMUSIC' = MUSIC with interfernece suppression feature.
    
    
    ShowConfiguration(sysPara);                     %% print simulation configuration.
    hAntennaElement = GenAntennaElement(sysPara);   %% Gen. antenna element
    hArray = GenArray(sysPara, hAntennaElement);    %% Gen. array
    
    mainArraySimRxBF
    
    recStvPartition = [0.912245099827192 + 0.409644819131496i,0.903267580081341 + 0.429077707151046i,0.894533868559222 + 0.447000176734274i,0.886127155442090 + 0.463442190988379i,0.878123545983241 + 0.478433943183194i,0.870592219009211 + 0.492005272533352i,0.863595594796613 + 0.504185133307086i,0.857189506658938 + 0.515001116186952i,0.851423371125146 + 0.524479020649913i,0.846340352131403 + 0.532642477046370i,0.841977515176557 + 0.539512617032365i,0.838365967908973 + 0.545107791039580i,0.835530984116668 + 0.549443331546605i,0.833492108584131 + 0.552531361035715i,0.832263240758894 + 0.554380643674996i,0.831852695639740 + 0.554996479950006i,0.832263240758894 + 0.554380643674996i,0.833492108584129 + 0.552531361035718i,0.835530984116666 + 0.549443331546608i,0.838365967908973 + 0.545107791039580i,0.841977515176557 + 0.539512617032365i,0.846340352131403 + 0.532642477046370i,0.851423371125146 + 0.524479020649913i,0.857189506658938 + 0.515001116186952i,0.863595594796613 + 0.504185133307086i,0.870592219009213 + 0.492005272533349i,0.878123545983241 + 0.478433943183194i,0.886127155442092 + 0.463442190988376i,0.894533868559222 + 0.447000176734274i,0.903267580081342 + 0.429077707151042i,0.912245099827192 + 0.409644819131496i,0.921376009778823 + 0.388672418115892i,0.930562543532330 + 0.366132971165724i,0.939699495417563 + 0.342001254839770i,0.948674167123330 + 0.316255157480249i,0.957366360166733 + 0.288876534909122i,0.965648423011661 + 0.259852117819139i,0.973385362059397 + 0.229174468317254i,0.980435026089629 + 0.196842982137106i,0.986648374007261 + 0.162864931979936i,0.991869835931605 + 0.127256546271737i,0.995937777731473 + 0.0900441163391323i,0.998685079041845 + 0.0512651236142363i,0.999939834574330 + 0.0109693769860702i,0.999526188132270 - 0.0307798511655593i,0.997265308139778 - 0.0739047033745044i,0.992976512669347 - 0.118311644765099i,0.986478550882918 - 0.163890416583577i,0.977591046464943 - 0.210513053922026i,0.966136107003309 - 0.258032987706010i,0.951940101347537 - 0.306284252690929i,0.934835604729082 - 0.355080824786150i,0.914663508855225 - 0.404216112455513i,0.891275291280607 - 0.453462628176423i,0.864535435119085 - 0.502571866923979i,0.834323986590494 - 0.551274419322850i,0.800539234017220 - 0.599280347416068i,0.763100487718403 - 0.646279850872620i,0.721950935828970 - 0.691944250829266i,0.677060546441822 - 0.735927317370337i,0.628428981690776 - 0.777866964828237i,0.576088484528824 - 0.817387336575068i,0.520106694092594 - 0.854101297715952i,0.460589340775468 - 0.887613350037064i,0.397682767566491 - 0.917522978666288i,0.331576219971887 - 0.943428434142810i,0.262503843053827 - 0.964930946950077i,0.190746320941244 - 0.981639364047398i,0.116632091743756 - 0.993175188562157i,0.0405380692926983 - 0.999177994622590i,-0.0371101972928961 - 0.999311179391526i,-0.115838994396057 - 0.993268003802252i,-0.195127610997052 - 0.980777862426851i,-0.274410264227140 - 0.961612711483574i,-0.353078840029247 - 0.935593572403959i,-0.430486498236009 - 0.902597016855528i,-0.505952182102922 - 0.862561527907020i,-0.578766061056863 - 0.815493621415106i,-0.648195922102152 - 0.761473602017917i,-0.713494509977684 - 0.700660819677898i,-0.773907798836483 - 0.633298285881203i,-0.828684159036867 - 0.559716503742171i,-0.877084361766975 - 0.480336363753378i,-0.918392341909975 - 0.395670957136244i,-0.951926616105261 - 0.306326162040378i,-0.977052228749259 - 0.212999864544806i,-0.993193074158877 - 0.116479686824959i,-0.999844418810381 - 0.0176391092102829i,-0.996585424052327 + 0.0825681086524514i,-0.983091447617777 + 0.183115279593984i,-0.959145882324304 + 0.282911958779286i,-0.924651273284716 + 0.380814945627078i,-0.879639441516472 + 0.475641096761612i,-0.824280332799833 + 0.566181890349204i,-0.758889306748230 + 0.651219640446440i,-0.683932583037852 + 0.729545215774302i,-0.600030570256652 + 0.799977071394847i,-0.507958818449491 + 0.861381355010310i,-0.408646359616298 + 0.912692803068123i,-0.303171231483562 + 0.952936096703625i,-0.192753018967435 + 0.981247305055632i,-0.0787422948363185 + 0.996895005004996i,0.0373931040986796 + 0.999300633326060i,0.154084966884498 + 0.988057601043686i,0.269684697504528 + 0.962948681878682i,0.382486262224455 + 0.923961178410417i,0.490751876116722 + 0.871299372252682i,0.592740128858252 + 0.805393779241622i,0.686736168234336 + 0.726906758283909i,0.771083479292617 + 0.636734063767592i,0.844216719986486 + 0.536001986652343i,0.904695002788402 + 0.426059798537357i,0.951234948600747 + 0.308467295771423i,0.982742786839992 + 0.184977336217079i,0.998344736281067 + 0.0575133683580370i,0.997414877471299 - 0.0718579306612242i,0.979599721411608 - 0.200958666920090i,0.944838692628592 - 0.327536020785338i,0.893379779228067 - 0.449302314779715i,0.825789659077483 - 0.563978225608662i,0.742957690425902 - 0.669338382462122i;0.628428981690773 - 0.777866964828240i,0.677060546441820 - 0.735927317370340i,0.721950935828965 - 0.691944250829271i,0.763100487718401 - 0.646279850872622i,0.800539234017220 - 0.599280347416068i,0.834323986590490 - 0.551274419322856i,0.864535435119085 - 0.502571866923979i,0.891275291280607 - 0.453462628176423i,0.914663508855225 - 0.404216112455513i,0.934835604729082 - 0.355080824786150i,0.951940101347535 - 0.306284252690936i,0.966136107003308 - 0.258032987706017i,0.977591046464942 - 0.210513053922029i,0.986478550882917 - 0.163890416583581i,0.992976512669347 - 0.118311644765099i,0.997265308139778 - 0.0739047033745044i,0.999526188132270 - 0.0307798511655628i,0.999939834574330 + 0.0109693769860666i,0.998685079041846 + 0.0512651236142292i,0.995937777731473 + 0.0900441163391323i,0.991869835931606 + 0.127256546271733i,0.986648374007261 + 0.162864931979932i,0.980435026089630 + 0.196842982137102i,0.973385362059398 + 0.229174468317250i,0.965648423011664 + 0.259852117819128i,0.957366360166734 + 0.288876534909118i,0.948674167123331 + 0.316255157480246i,0.939699495417565 + 0.342001254839766i,0.930562543532330 + 0.366132971165724i,0.921376009778826 + 0.388672418115886i,0.912245099827194 + 0.409644819131493i,0.903267580081342 + 0.429077707151042i,0.894533868559222 + 0.447000176734274i,0.886127155442094 + 0.463442190988373i,0.878123545983242 + 0.478433943183191i,0.870592219009214 + 0.492005272533346i,0.863595594796613 + 0.504185133307086i,0.857189506658942 + 0.515001116186945i,0.851423371125146 + 0.524479020649913i,0.846340352131405 + 0.532642477046367i,0.841977515176559 + 0.539512617032362i,0.838365967908973 + 0.545107791039580i,0.835530984116668 + 0.549443331546605i,0.833492108584133 + 0.552531361035712i,0.832263240758896 + 0.554380643674993i,0.831852695639742 + 0.554996479950003i,0.832263240758896 + 0.554380643674993i,0.833492108584133 + 0.552531361035712i,0.835530984116668 + 0.549443331546605i,0.838365967908973 + 0.545107791039580i,0.841977515176559 + 0.539512617032362i,0.846340352131405 + 0.532642477046367i,0.851423371125148 + 0.524479020649910i,0.857189506658940 + 0.515001116186948i,0.863595594796617 + 0.504185133307080i,0.870592219009214 + 0.492005272533346i,0.878123545983242 + 0.478433943183191i,0.886127155442092 + 0.463442190988376i,0.894533868559222 + 0.447000176734274i,0.903267580081341 + 0.429077707151046i,0.912245099827194 + 0.409644819131493i,0.921376009778824 + 0.388672418115889i,0.930562543532330 + 0.366132971165724i,0.939699495417563 + 0.342001254839770i,0.948674167123331 + 0.316255157480246i,0.957366360166734 + 0.288876534909118i,0.965648423011663 + 0.259852117819132i,0.973385362059398 + 0.229174468317250i,0.980435026089630 + 0.196842982137102i,0.986648374007262 + 0.162864931979929i,0.991869835931605 + 0.127256546271737i,0.995937777731473 + 0.0900441163391323i,0.998685079041846 + 0.0512651236142292i,0.999939834574330 + 0.0109693769860666i,0.999526188132270 - 0.0307798511655628i,0.997265308139778 - 0.0739047033745044i,0.992976512669347 - 0.118311644765099i,0.986478550882918 - 0.163890416583577i,0.977591046464943 - 0.210513053922026i,0.966136107003308 - 0.258032987706017i,0.951940101347535 - 0.306284252690936i,0.934835604729082 - 0.355080824786150i,0.914663508855225 - 0.404216112455513i,0.891275291280607 - 0.453462628176423i,0.864535435119085 - 0.502571866923979i,0.834323986590490 - 0.551274419322856i,0.800539234017217 - 0.599280347416071i,0.763100487718401 - 0.646279850872622i,0.721950935828968 - 0.691944250829269i,0.677060546441820 - 0.735927317370340i,0.628428981690776 - 0.777866964828237i,0.576088484528821 - 0.817387336575070i,0.520106694092591 - 0.854101297715954i,0.460589340775464 - 0.887613350037066i,0.397682767566491 - 0.917522978666288i,0.331576219971884 - 0.943428434142811i,0.262503843053827 - 0.964930946950077i,0.190746320941240 - 0.981639364047399i,0.116632091743756 - 0.993175188562157i,0.0405380692926947 - 0.999177994622590i,-0.0371101972928996 - 0.999311179391526i,-0.115838994396057 - 0.993268003802252i,-0.195127610997052 - 0.980777862426851i,-0.274410264227140 - 0.961612711483574i,-0.353078840029251 - 0.935593572403957i,-0.430486498236009 - 0.902597016855528i,-0.505952182102925 - 0.862561527907018i,-0.578766061056866 - 0.815493621415104i,-0.648195922102154 - 0.761473602017915i,-0.713494509977689 - 0.700660819677893i,-0.773907798836483 - 0.633298285881203i,-0.828684159036867 - 0.559716503742171i,-0.877084361766977 - 0.480336363753375i,-0.918392341909975 - 0.395670957136244i,-0.951926616105261 - 0.306326162040378i,-0.977052228749260 - 0.212999864544801i,-0.993193074158877 - 0.116479686824959i,-0.999844418810381 - 0.0176391092102793i,-0.996585424052327 + 0.0825681086524567i,-0.983091447617777 + 0.183115279593984i,-0.959145882324304 + 0.282911958779286i;-0.959145882324304 + 0.282911958779286i,-0.983091447617777 + 0.183115279593984i,-0.996585424052327 + 0.0825681086524567i,-0.999844418810381 - 0.0176391092102793i,-0.993193074158877 - 0.116479686824959i,-0.977052228749260 - 0.212999864544801i,-0.951926616105261 - 0.306326162040378i,-0.918392341909975 - 0.395670957136244i,-0.877084361766977 - 0.480336363753375i,-0.828684159036867 - 0.559716503742171i,-0.773907798836483 - 0.633298285881203i,-0.713494509977689 - 0.700660819677893i,-0.648195922102154 - 0.761473602017915i,-0.578766061056866 - 0.815493621415104i,-0.505952182102925 - 0.862561527907018i,-0.430486498236009 - 0.902597016855528i,-0.353078840029251 - 0.935593572403957i,-0.274410264227140 - 0.961612711483574i,-0.195127610997052 - 0.980777862426851i,-0.115838994396057 - 0.993268003802252i,-0.0371101972928996 - 0.999311179391526i,0.0405380692926947 - 0.999177994622590i,0.116632091743756 - 0.993175188562157i,0.190746320941240 - 0.981639364047399i,0.262503843053827 - 0.964930946950077i,0.331576219971884 - 0.943428434142811i,0.397682767566491 - 0.917522978666288i,0.460589340775464 - 0.887613350037066i,0.520106694092591 - 0.854101297715954i,0.576088484528821 - 0.817387336575070i,0.628428981690776 - 0.777866964828237i,0.677060546441820 - 0.735927317370340i,0.721950935828968 - 0.691944250829269i,0.763100487718401 - 0.646279850872622i,0.800539234017217 - 0.599280347416071i,0.834323986590490 - 0.551274419322856i,0.864535435119085 - 0.502571866923979i,0.891275291280607 - 0.453462628176423i,0.914663508855225 - 0.404216112455513i,0.934835604729082 - 0.355080824786150i,0.951940101347535 - 0.306284252690936i,0.966136107003308 - 0.258032987706017i,0.977591046464943 - 0.210513053922026i,0.986478550882918 - 0.163890416583577i,0.992976512669347 - 0.118311644765099i,0.997265308139778 - 0.0739047033745044i,0.999526188132270 - 0.0307798511655628i,0.999939834574330 + 0.0109693769860666i,0.998685079041846 + 0.0512651236142292i,0.995937777731473 + 0.0900441163391323i,0.991869835931605 + 0.127256546271737i,0.986648374007262 + 0.162864931979929i,0.980435026089630 + 0.196842982137102i,0.973385362059398 + 0.229174468317250i,0.965648423011663 + 0.259852117819132i,0.957366360166734 + 0.288876534909118i,0.948674167123331 + 0.316255157480246i,0.939699495417563 + 0.342001254839770i,0.930562543532330 + 0.366132971165724i,0.921376009778824 + 0.388672418115889i,0.912245099827194 + 0.409644819131493i,0.903267580081341 + 0.429077707151046i,0.894533868559222 + 0.447000176734274i,0.886127155442092 + 0.463442190988376i,0.878123545983242 + 0.478433943183191i,0.870592219009214 + 0.492005272533346i,0.863595594796617 + 0.504185133307080i,0.857189506658940 + 0.515001116186948i,0.851423371125148 + 0.524479020649910i,0.846340352131405 + 0.532642477046367i,0.841977515176559 + 0.539512617032362i,0.838365967908973 + 0.545107791039580i,0.835530984116668 + 0.549443331546605i,0.833492108584133 + 0.552531361035712i,0.832263240758896 + 0.554380643674993i,0.831852695639742 + 0.554996479950003i,0.832263240758896 + 0.554380643674993i,0.833492108584133 + 0.552531361035712i,0.835530984116668 + 0.549443331546605i,0.838365967908973 + 0.545107791039580i,0.841977515176559 + 0.539512617032362i,0.846340352131405 + 0.532642477046367i,0.851423371125146 + 0.524479020649913i,0.857189506658942 + 0.515001116186945i,0.863595594796613 + 0.504185133307086i,0.870592219009214 + 0.492005272533346i,0.878123545983242 + 0.478433943183191i,0.886127155442094 + 0.463442190988373i,0.894533868559222 + 0.447000176734274i,0.903267580081342 + 0.429077707151042i,0.912245099827194 + 0.409644819131493i,0.921376009778826 + 0.388672418115886i,0.930562543532330 + 0.366132971165724i,0.939699495417565 + 0.342001254839766i,0.948674167123331 + 0.316255157480246i,0.957366360166734 + 0.288876534909118i,0.965648423011664 + 0.259852117819128i,0.973385362059398 + 0.229174468317250i,0.980435026089630 + 0.196842982137102i,0.986648374007261 + 0.162864931979932i,0.991869835931606 + 0.127256546271733i,0.995937777731473 + 0.0900441163391323i,0.998685079041846 + 0.0512651236142292i,0.999939834574330 + 0.0109693769860666i,0.999526188132270 - 0.0307798511655628i,0.997265308139778 - 0.0739047033745044i,0.992976512669347 - 0.118311644765099i,0.986478550882917 - 0.163890416583581i,0.977591046464942 - 0.210513053922029i,0.966136107003308 - 0.258032987706017i,0.951940101347535 - 0.306284252690936i,0.934835604729082 - 0.355080824786150i,0.914663508855225 - 0.404216112455513i,0.891275291280607 - 0.453462628176423i,0.864535435119085 - 0.502571866923979i,0.834323986590490 - 0.551274419322856i,0.800539234017220 - 0.599280347416068i,0.763100487718401 - 0.646279850872622i,0.721950935828965 - 0.691944250829271i,0.677060546441820 - 0.735927317370340i,0.628428981690773 - 0.777866964828240i;0.742957690425902 - 0.669338382462122i,0.825789659077483 - 0.563978225608662i,0.893379779228067 - 0.449302314779715i,0.944838692628592 - 0.327536020785338i,0.979599721411608 - 0.200958666920090i,0.997414877471299 - 0.0718579306612242i,0.998344736281067 + 0.0575133683580370i,0.982742786839992 + 0.184977336217079i,0.951234948600747 + 0.308467295771423i,0.904695002788402 + 0.426059798537357i,0.844216719986486 + 0.536001986652343i,0.771083479292617 + 0.636734063767592i,0.686736168234336 + 0.726906758283909i,0.592740128858252 + 0.805393779241622i,0.490751876116722 + 0.871299372252682i,0.382486262224455 + 0.923961178410417i,0.269684697504528 + 0.962948681878682i,0.154084966884498 + 0.988057601043686i,0.0373931040986796 + 0.999300633326060i,-0.0787422948363185 + 0.996895005004996i,-0.192753018967435 + 0.981247305055632i,-0.303171231483562 + 0.952936096703625i,-0.408646359616298 + 0.912692803068123i,-0.507958818449491 + 0.861381355010310i,-0.600030570256652 + 0.799977071394847i,-0.683932583037852 + 0.729545215774302i,-0.758889306748230 + 0.651219640446440i,-0.824280332799833 + 0.566181890349204i,-0.879639441516472 + 0.475641096761612i,-0.924651273284716 + 0.380814945627078i,-0.959145882324304 + 0.282911958779286i,-0.983091447617777 + 0.183115279593984i,-0.996585424052327 + 0.0825681086524514i,-0.999844418810381 - 0.0176391092102829i,-0.993193074158877 - 0.116479686824959i,-0.977052228749259 - 0.212999864544806i,-0.951926616105261 - 0.306326162040378i,-0.918392341909975 - 0.395670957136244i,-0.877084361766975 - 0.480336363753378i,-0.828684159036867 - 0.559716503742171i,-0.773907798836483 - 0.633298285881203i,-0.713494509977684 - 0.700660819677898i,-0.648195922102152 - 0.761473602017917i,-0.578766061056863 - 0.815493621415106i,-0.505952182102922 - 0.862561527907020i,-0.430486498236009 - 0.902597016855528i,-0.353078840029247 - 0.935593572403959i,-0.274410264227140 - 0.961612711483574i,-0.195127610997052 - 0.980777862426851i,-0.115838994396057 - 0.993268003802252i,-0.0371101972928961 - 0.999311179391526i,0.0405380692926983 - 0.999177994622590i,0.116632091743756 - 0.993175188562157i,0.190746320941244 - 0.981639364047398i,0.262503843053827 - 0.964930946950077i,0.331576219971887 - 0.943428434142810i,0.397682767566491 - 0.917522978666288i,0.460589340775468 - 0.887613350037064i,0.520106694092594 - 0.854101297715952i,0.576088484528824 - 0.817387336575068i,0.628428981690776 - 0.777866964828237i,0.677060546441822 - 0.735927317370337i,0.721950935828970 - 0.691944250829266i,0.763100487718403 - 0.646279850872620i,0.800539234017220 - 0.599280347416068i,0.834323986590494 - 0.551274419322850i,0.864535435119085 - 0.502571866923979i,0.891275291280607 - 0.453462628176423i,0.914663508855225 - 0.404216112455513i,0.934835604729082 - 0.355080824786150i,0.951940101347537 - 0.306284252690929i,0.966136107003309 - 0.258032987706010i,0.977591046464943 - 0.210513053922026i,0.986478550882918 - 0.163890416583577i,0.992976512669347 - 0.118311644765099i,0.997265308139778 - 0.0739047033745044i,0.999526188132270 - 0.0307798511655593i,0.999939834574330 + 0.0109693769860702i,0.998685079041845 + 0.0512651236142363i,0.995937777731473 + 0.0900441163391323i,0.991869835931605 + 0.127256546271737i,0.986648374007261 + 0.162864931979936i,0.980435026089629 + 0.196842982137106i,0.973385362059397 + 0.229174468317254i,0.965648423011661 + 0.259852117819139i,0.957366360166733 + 0.288876534909122i,0.948674167123330 + 0.316255157480249i,0.939699495417563 + 0.342001254839770i,0.930562543532330 + 0.366132971165724i,0.921376009778823 + 0.388672418115892i,0.912245099827192 + 0.409644819131496i,0.903267580081342 + 0.429077707151042i,0.894533868559222 + 0.447000176734274i,0.886127155442092 + 0.463442190988376i,0.878123545983241 + 0.478433943183194i,0.870592219009213 + 0.492005272533349i,0.863595594796613 + 0.504185133307086i,0.857189506658938 + 0.515001116186952i,0.851423371125146 + 0.524479020649913i,0.846340352131403 + 0.532642477046370i,0.841977515176557 + 0.539512617032365i,0.838365967908973 + 0.545107791039580i,0.835530984116666 + 0.549443331546608i,0.833492108584129 + 0.552531361035718i,0.832263240758894 + 0.554380643674996i,0.831852695639740 + 0.554996479950006i,0.832263240758894 + 0.554380643674996i,0.833492108584131 + 0.552531361035715i,0.835530984116668 + 0.549443331546605i,0.838365967908973 + 0.545107791039580i,0.841977515176557 + 0.539512617032365i,0.846340352131403 + 0.532642477046370i,0.851423371125146 + 0.524479020649913i,0.857189506658938 + 0.515001116186952i,0.863595594796613 + 0.504185133307086i,0.870592219009211 + 0.492005272533352i,0.878123545983241 + 0.478433943183194i,0.886127155442090 + 0.463442190988379i,0.894533868559222 + 0.447000176734274i,0.903267580081341 + 0.429077707151046i,0.912245099827192 + 0.409644819131496i];
    AzimuthScanAngles = (-30:0.5:30).';
    [~, doaImplement]  = DoaEstimatorMUSICSignalImplement(recStvPartition, waveformRx, AzimuthScanAngles, 1);
    if abs(doaImplement - doa(1,1)) > 0.5
        error('Implementation is inconsistent with simulation!')
    end
    
    [~, doaImplement]  = DoaEstimatorMUSICSignalImplement_mex(recStvPartition, waveformRx, AzimuthScanAngles, 1);
    if abs(doaImplement - doa(1,1)) > 0.5
        error('Mex Implementation is inconsistent with simulation!')
    end
end

cd(CurrentDirectory);