% /*!
%  *  @brief     This script is used to test the DoaEstimationMusicSignalImplement for code generation.
%  *  @details  . 
%  *  @pre       .
%  *  @bug      Null
%  *  @warning  Null
%  *  @author    Collus Wang
%  *  @version   1.0
%  *  @date      2017.10.17
%  *  @copyright Collus Wang all rights reserved.
%  * @remark   { revision history: V1.0 2017.10.18. Collus Wang, first draft }
%  * @remark   { revision history: V1.1 2017.10.20. Collus Wang, 1. make sure the working folder is current m-file folder. 2. check mex result 3. use anitInterMuisc instead of Music.}
%  */

%% clear
clear all %#ok<CLALL>
close all
clc
% make sure the working folder is current m-file folder.
filePath= mfilename('fullpath');
idx=strfind(filePath,'\');
CurrentDirectory=filePath(1:idx(end));
cd(CurrentDirectory)
addpath(CurrentDirectory)
cd('..\..')
ScriptCall = true;
FlagCompareMex = true;

testTargetAngleRange = [(-20:20); zeros(1,41)];
for idxAngle = 1:size(testTargetAngleRange,2)
    
    %% prepare
    sysPara = GenSysPara();                         %% Gen. System para.
    sysPara.FlagAnalyzeWaveform = false;
    sysPara.FlagBeamforming = false;
    
    sysPara.TargetSigType = 'CustomPilot';     % string. target singal type. valid value = {'QPSK', '16QAM', '64QAM', 'CustomPilot'}
    sysPara.NumTarget = 1;              % interger scaler. number of target
    sysPara.TargetAngle = testTargetAngleRange(:,idxAngle);      % double 2xN matrix. incoming wave direction in degree, [azimuth; elevation]. Each column represents one target.

    
    sysPara.SwitchAWGN = true;          % boolen scaler. switch flag of AWGN.  true = add noise; false = not add noise.
    sysPara.SNR = 20;                   % double scaler. SNR, in dB, in-channel SNR. Valid only when SwitchAWGN = true.
    
    sysPara.SwitchInterence = false;    % boolen scaler. true = enable interference; false = disable interference.
    sysPara.DoaEstimator = 'AntiInterMUSIC';     % string. DOA estimator type. valid value = {'ToolboxMusicEstimator2D', 'CBF', 'MUSIC', 'AntiInterMUSIC'}
    % 'ToolboxMusicEstimator2D' = using system toolbox for music estimator.
    % 'CBF' = Conventional Beamforming DOA
    % 'MUSIC' = MUSIC without interference suppression feature.
    % 'AntiInterMUSIC' = MUSIC with interfernece suppression feature.
    
    
    ShowConfiguration(sysPara);                     %% print simulation configuration.
    hAntennaElement = GenAntennaElement(sysPara);   %% Gen. antenna element
    hArray = GenArray(sysPara, hAntennaElement);    %% Gen. array
    
    mainArraySimRxBF
    
    recStvPartition = [0.912245099827192 + 0.409644819131496i,0.903267580081341 + 0.429077707151046i,0.894533868559222 + 0.447000176734274i,0.886127155442090 + 0.463442190988379i,0.878123545983241 + 0.478433943183194i,0.870592219009211 + 0.492005272533352i,0.863595594796613 + 0.504185133307086i,0.857189506658938 + 0.515001116186952i,0.851423371125146 + 0.524479020649913i,0.846340352131403 + 0.532642477046370i,0.841977515176557 + 0.539512617032365i,0.838365967908973 + 0.545107791039580i,0.835530984116668 + 0.549443331546605i,0.833492108584131 + 0.552531361035715i,0.832263240758894 + 0.554380643674996i,0.831852695639740 + 0.554996479950006i,0.832263240758894 + 0.554380643674996i,0.833492108584129 + 0.552531361035718i,0.835530984116666 + 0.549443331546608i,0.838365967908973 + 0.545107791039580i,0.841977515176557 + 0.539512617032365i,0.846340352131403 + 0.532642477046370i,0.851423371125146 + 0.524479020649913i,0.857189506658938 + 0.515001116186952i,0.863595594796613 + 0.504185133307086i,0.870592219009213 + 0.492005272533349i,0.878123545983241 + 0.478433943183194i,0.886127155442092 + 0.463442190988376i,0.894533868559222 + 0.447000176734274i,0.903267580081342 + 0.429077707151042i,0.912245099827192 + 0.409644819131496i,0.921376009778823 + 0.388672418115892i,0.930562543532330 + 0.366132971165724i,0.939699495417563 + 0.342001254839770i,0.948674167123330 + 0.316255157480249i,0.957366360166733 + 0.288876534909122i,0.965648423011661 + 0.259852117819139i,0.973385362059397 + 0.229174468317254i,0.980435026089629 + 0.196842982137106i,0.986648374007261 + 0.162864931979936i,0.991869835931605 + 0.127256546271737i,0.995937777731473 + 0.0900441163391323i,0.998685079041845 + 0.0512651236142363i,0.999939834574330 + 0.0109693769860702i,0.999526188132270 - 0.0307798511655593i,0.997265308139778 - 0.0739047033745044i,0.992976512669347 - 0.118311644765099i,0.986478550882918 - 0.163890416583577i,0.977591046464943 - 0.210513053922026i,0.966136107003309 - 0.258032987706010i,0.951940101347537 - 0.306284252690929i,0.934835604729082 - 0.355080824786150i,0.914663508855225 - 0.404216112455513i,0.891275291280607 - 0.453462628176423i,0.864535435119085 - 0.502571866923979i,0.834323986590494 - 0.551274419322850i,0.800539234017220 - 0.599280347416068i,0.763100487718403 - 0.646279850872620i,0.721950935828970 - 0.691944250829266i,0.677060546441822 - 0.735927317370337i,0.628428981690776 - 0.777866964828237i,0.576088484528824 - 0.817387336575068i,0.520106694092594 - 0.854101297715952i,0.460589340775468 - 0.887613350037064i,0.397682767566491 - 0.917522978666288i,0.331576219971887 - 0.943428434142810i,0.262503843053827 - 0.964930946950077i,0.190746320941244 - 0.981639364047398i,0.116632091743756 - 0.993175188562157i,0.0405380692926983 - 0.999177994622590i,-0.0371101972928961 - 0.999311179391526i,-0.115838994396057 - 0.993268003802252i,-0.195127610997052 - 0.980777862426851i,-0.274410264227140 - 0.961612711483574i,-0.353078840029247 - 0.935593572403959i,-0.430486498236009 - 0.902597016855528i,-0.505952182102922 - 0.862561527907020i,-0.578766061056863 - 0.815493621415106i,-0.648195922102152 - 0.761473602017917i,-0.713494509977684 - 0.700660819677898i,-0.773907798836483 - 0.633298285881203i,-0.828684159036867 - 0.559716503742171i,-0.877084361766975 - 0.480336363753378i,-0.918392341909975 - 0.395670957136244i,-0.951926616105261 - 0.306326162040378i,-0.977052228749259 - 0.212999864544806i,-0.993193074158877 - 0.116479686824959i,-0.999844418810381 - 0.0176391092102829i,-0.996585424052327 + 0.0825681086524514i,-0.983091447617777 + 0.183115279593984i,-0.959145882324304 + 0.282911958779286i,-0.924651273284716 + 0.380814945627078i,-0.879639441516472 + 0.475641096761612i,-0.824280332799833 + 0.566181890349204i,-0.758889306748230 + 0.651219640446440i,-0.683932583037852 + 0.729545215774302i,-0.600030570256652 + 0.799977071394847i,-0.507958818449491 + 0.861381355010310i,-0.408646359616298 + 0.912692803068123i,-0.303171231483562 + 0.952936096703625i,-0.192753018967435 + 0.981247305055632i,-0.0787422948363185 + 0.996895005004996i,0.0373931040986796 + 0.999300633326060i,0.154084966884498 + 0.988057601043686i,0.269684697504528 + 0.962948681878682i,0.382486262224455 + 0.923961178410417i,0.490751876116722 + 0.871299372252682i,0.592740128858252 + 0.805393779241622i,0.686736168234336 + 0.726906758283909i,0.771083479292617 + 0.636734063767592i,0.844216719986486 + 0.536001986652343i,0.904695002788402 + 0.426059798537357i,0.951234948600747 + 0.308467295771423i,0.982742786839992 + 0.184977336217079i,0.998344736281067 + 0.0575133683580370i,0.997414877471299 - 0.0718579306612242i,0.979599721411608 - 0.200958666920090i,0.944838692628592 - 0.327536020785338i,0.893379779228067 - 0.449302314779715i,0.825789659077483 - 0.563978225608662i,0.742957690425902 - 0.669338382462122i;0.628428981690773 - 0.777866964828240i,0.677060546441820 - 0.735927317370340i,0.721950935828965 - 0.691944250829271i,0.763100487718401 - 0.646279850872622i,0.800539234017220 - 0.599280347416068i,0.834323986590490 - 0.551274419322856i,0.864535435119085 - 0.502571866923979i,0.891275291280607 - 0.453462628176423i,0.914663508855225 - 0.404216112455513i,0.934835604729082 - 0.355080824786150i,0.951940101347535 - 0.306284252690936i,0.966136107003308 - 0.258032987706017i,0.977591046464942 - 0.210513053922029i,0.986478550882917 - 0.163890416583581i,0.992976512669347 - 0.118311644765099i,0.997265308139778 - 0.0739047033745044i,0.999526188132270 - 0.0307798511655628i,0.999939834574330 + 0.0109693769860666i,0.998685079041846 + 0.0512651236142292i,0.995937777731473 + 0.0900441163391323i,0.991869835931606 + 0.127256546271733i,0.986648374007261 + 0.162864931979932i,0.980435026089630 + 0.196842982137102i,0.973385362059398 + 0.229174468317250i,0.965648423011664 + 0.259852117819128i,0.957366360166734 + 0.288876534909118i,0.948674167123331 + 0.316255157480246i,0.939699495417565 + 0.342001254839766i,0.930562543532330 + 0.366132971165724i,0.921376009778826 + 0.388672418115886i,0.912245099827194 + 0.409644819131493i,0.903267580081342 + 0.429077707151042i,0.894533868559222 + 0.447000176734274i,0.886127155442094 + 0.463442190988373i,0.878123545983242 + 0.478433943183191i,0.870592219009214 + 0.492005272533346i,0.863595594796613 + 0.504185133307086i,0.857189506658942 + 0.515001116186945i,0.851423371125146 + 0.524479020649913i,0.846340352131405 + 0.532642477046367i,0.841977515176559 + 0.539512617032362i,0.838365967908973 + 0.545107791039580i,0.835530984116668 + 0.549443331546605i,0.833492108584133 + 0.552531361035712i,0.832263240758896 + 0.554380643674993i,0.831852695639742 + 0.554996479950003i,0.832263240758896 + 0.554380643674993i,0.833492108584133 + 0.552531361035712i,0.835530984116668 + 0.549443331546605i,0.838365967908973 + 0.545107791039580i,0.841977515176559 + 0.539512617032362i,0.846340352131405 + 0.532642477046367i,0.851423371125148 + 0.524479020649910i,0.857189506658940 + 0.515001116186948i,0.863595594796617 + 0.504185133307080i,0.870592219009214 + 0.492005272533346i,0.878123545983242 + 0.478433943183191i,0.886127155442092 + 0.463442190988376i,0.894533868559222 + 0.447000176734274i,0.903267580081341 + 0.429077707151046i,0.912245099827194 + 0.409644819131493i,0.921376009778824 + 0.388672418115889i,0.930562543532330 + 0.366132971165724i,0.939699495417563 + 0.342001254839770i,0.948674167123331 + 0.316255157480246i,0.957366360166734 + 0.288876534909118i,0.965648423011663 + 0.259852117819132i,0.973385362059398 + 0.229174468317250i,0.980435026089630 + 0.196842982137102i,0.986648374007262 + 0.162864931979929i,0.991869835931605 + 0.127256546271737i,0.995937777731473 + 0.0900441163391323i,0.998685079041846 + 0.0512651236142292i,0.999939834574330 + 0.0109693769860666i,0.999526188132270 - 0.0307798511655628i,0.997265308139778 - 0.0739047033745044i,0.992976512669347 - 0.118311644765099i,0.986478550882918 - 0.163890416583577i,0.977591046464943 - 0.210513053922026i,0.966136107003308 - 0.258032987706017i,0.951940101347535 - 0.306284252690936i,0.934835604729082 - 0.355080824786150i,0.914663508855225 - 0.404216112455513i,0.891275291280607 - 0.453462628176423i,0.864535435119085 - 0.502571866923979i,0.834323986590490 - 0.551274419322856i,0.800539234017217 - 0.599280347416071i,0.763100487718401 - 0.646279850872622i,0.721950935828968 - 0.691944250829269i,0.677060546441820 - 0.735927317370340i,0.628428981690776 - 0.777866964828237i,0.576088484528821 - 0.817387336575070i,0.520106694092591 - 0.854101297715954i,0.460589340775464 - 0.887613350037066i,0.397682767566491 - 0.917522978666288i,0.331576219971884 - 0.943428434142811i,0.262503843053827 - 0.964930946950077i,0.190746320941240 - 0.981639364047399i,0.116632091743756 - 0.993175188562157i,0.0405380692926947 - 0.999177994622590i,-0.0371101972928996 - 0.999311179391526i,-0.115838994396057 - 0.993268003802252i,-0.195127610997052 - 0.980777862426851i,-0.274410264227140 - 0.961612711483574i,-0.353078840029251 - 0.935593572403957i,-0.430486498236009 - 0.902597016855528i,-0.505952182102925 - 0.862561527907018i,-0.578766061056866 - 0.815493621415104i,-0.648195922102154 - 0.761473602017915i,-0.713494509977689 - 0.700660819677893i,-0.773907798836483 - 0.633298285881203i,-0.828684159036867 - 0.559716503742171i,-0.877084361766977 - 0.480336363753375i,-0.918392341909975 - 0.395670957136244i,-0.951926616105261 - 0.306326162040378i,-0.977052228749260 - 0.212999864544801i,-0.993193074158877 - 0.116479686824959i,-0.999844418810381 - 0.0176391092102793i,-0.996585424052327 + 0.0825681086524567i,-0.983091447617777 + 0.183115279593984i,-0.959145882324304 + 0.282911958779286i;-0.959145882324304 + 0.282911958779286i,-0.983091447617777 + 0.183115279593984i,-0.996585424052327 + 0.0825681086524567i,-0.999844418810381 - 0.0176391092102793i,-0.993193074158877 - 0.116479686824959i,-0.977052228749260 - 0.212999864544801i,-0.951926616105261 - 0.306326162040378i,-0.918392341909975 - 0.395670957136244i,-0.877084361766977 - 0.480336363753375i,-0.828684159036867 - 0.559716503742171i,-0.773907798836483 - 0.633298285881203i,-0.713494509977689 - 0.700660819677893i,-0.648195922102154 - 0.761473602017915i,-0.578766061056866 - 0.815493621415104i,-0.505952182102925 - 0.862561527907018i,-0.430486498236009 - 0.902597016855528i,-0.353078840029251 - 0.935593572403957i,-0.274410264227140 - 0.961612711483574i,-0.195127610997052 - 0.980777862426851i,-0.115838994396057 - 0.993268003802252i,-0.0371101972928996 - 0.999311179391526i,0.0405380692926947 - 0.999177994622590i,0.116632091743756 - 0.993175188562157i,0.190746320941240 - 0.981639364047399i,0.262503843053827 - 0.964930946950077i,0.331576219971884 - 0.943428434142811i,0.397682767566491 - 0.917522978666288i,0.460589340775464 - 0.887613350037066i,0.520106694092591 - 0.854101297715954i,0.576088484528821 - 0.817387336575070i,0.628428981690776 - 0.777866964828237i,0.677060546441820 - 0.735927317370340i,0.721950935828968 - 0.691944250829269i,0.763100487718401 - 0.646279850872622i,0.800539234017217 - 0.599280347416071i,0.834323986590490 - 0.551274419322856i,0.864535435119085 - 0.502571866923979i,0.891275291280607 - 0.453462628176423i,0.914663508855225 - 0.404216112455513i,0.934835604729082 - 0.355080824786150i,0.951940101347535 - 0.306284252690936i,0.966136107003308 - 0.258032987706017i,0.977591046464943 - 0.210513053922026i,0.986478550882918 - 0.163890416583577i,0.992976512669347 - 0.118311644765099i,0.997265308139778 - 0.0739047033745044i,0.999526188132270 - 0.0307798511655628i,0.999939834574330 + 0.0109693769860666i,0.998685079041846 + 0.0512651236142292i,0.995937777731473 + 0.0900441163391323i,0.991869835931605 + 0.127256546271737i,0.986648374007262 + 0.162864931979929i,0.980435026089630 + 0.196842982137102i,0.973385362059398 + 0.229174468317250i,0.965648423011663 + 0.259852117819132i,0.957366360166734 + 0.288876534909118i,0.948674167123331 + 0.316255157480246i,0.939699495417563 + 0.342001254839770i,0.930562543532330 + 0.366132971165724i,0.921376009778824 + 0.388672418115889i,0.912245099827194 + 0.409644819131493i,0.903267580081341 + 0.429077707151046i,0.894533868559222 + 0.447000176734274i,0.886127155442092 + 0.463442190988376i,0.878123545983242 + 0.478433943183191i,0.870592219009214 + 0.492005272533346i,0.863595594796617 + 0.504185133307080i,0.857189506658940 + 0.515001116186948i,0.851423371125148 + 0.524479020649910i,0.846340352131405 + 0.532642477046367i,0.841977515176559 + 0.539512617032362i,0.838365967908973 + 0.545107791039580i,0.835530984116668 + 0.549443331546605i,0.833492108584133 + 0.552531361035712i,0.832263240758896 + 0.554380643674993i,0.831852695639742 + 0.554996479950003i,0.832263240758896 + 0.554380643674993i,0.833492108584133 + 0.552531361035712i,0.835530984116668 + 0.549443331546605i,0.838365967908973 + 0.545107791039580i,0.841977515176559 + 0.539512617032362i,0.846340352131405 + 0.532642477046367i,0.851423371125146 + 0.524479020649913i,0.857189506658942 + 0.515001116186945i,0.863595594796613 + 0.504185133307086i,0.870592219009214 + 0.492005272533346i,0.878123545983242 + 0.478433943183191i,0.886127155442094 + 0.463442190988373i,0.894533868559222 + 0.447000176734274i,0.903267580081342 + 0.429077707151042i,0.912245099827194 + 0.409644819131493i,0.921376009778826 + 0.388672418115886i,0.930562543532330 + 0.366132971165724i,0.939699495417565 + 0.342001254839766i,0.948674167123331 + 0.316255157480246i,0.957366360166734 + 0.288876534909118i,0.965648423011664 + 0.259852117819128i,0.973385362059398 + 0.229174468317250i,0.980435026089630 + 0.196842982137102i,0.986648374007261 + 0.162864931979932i,0.991869835931606 + 0.127256546271733i,0.995937777731473 + 0.0900441163391323i,0.998685079041846 + 0.0512651236142292i,0.999939834574330 + 0.0109693769860666i,0.999526188132270 - 0.0307798511655628i,0.997265308139778 - 0.0739047033745044i,0.992976512669347 - 0.118311644765099i,0.986478550882917 - 0.163890416583581i,0.977591046464942 - 0.210513053922029i,0.966136107003308 - 0.258032987706017i,0.951940101347535 - 0.306284252690936i,0.934835604729082 - 0.355080824786150i,0.914663508855225 - 0.404216112455513i,0.891275291280607 - 0.453462628176423i,0.864535435119085 - 0.502571866923979i,0.834323986590490 - 0.551274419322856i,0.800539234017220 - 0.599280347416068i,0.763100487718401 - 0.646279850872622i,0.721950935828965 - 0.691944250829271i,0.677060546441820 - 0.735927317370340i,0.628428981690773 - 0.777866964828240i;0.742957690425902 - 0.669338382462122i,0.825789659077483 - 0.563978225608662i,0.893379779228067 - 0.449302314779715i,0.944838692628592 - 0.327536020785338i,0.979599721411608 - 0.200958666920090i,0.997414877471299 - 0.0718579306612242i,0.998344736281067 + 0.0575133683580370i,0.982742786839992 + 0.184977336217079i,0.951234948600747 + 0.308467295771423i,0.904695002788402 + 0.426059798537357i,0.844216719986486 + 0.536001986652343i,0.771083479292617 + 0.636734063767592i,0.686736168234336 + 0.726906758283909i,0.592740128858252 + 0.805393779241622i,0.490751876116722 + 0.871299372252682i,0.382486262224455 + 0.923961178410417i,0.269684697504528 + 0.962948681878682i,0.154084966884498 + 0.988057601043686i,0.0373931040986796 + 0.999300633326060i,-0.0787422948363185 + 0.996895005004996i,-0.192753018967435 + 0.981247305055632i,-0.303171231483562 + 0.952936096703625i,-0.408646359616298 + 0.912692803068123i,-0.507958818449491 + 0.861381355010310i,-0.600030570256652 + 0.799977071394847i,-0.683932583037852 + 0.729545215774302i,-0.758889306748230 + 0.651219640446440i,-0.824280332799833 + 0.566181890349204i,-0.879639441516472 + 0.475641096761612i,-0.924651273284716 + 0.380814945627078i,-0.959145882324304 + 0.282911958779286i,-0.983091447617777 + 0.183115279593984i,-0.996585424052327 + 0.0825681086524514i,-0.999844418810381 - 0.0176391092102829i,-0.993193074158877 - 0.116479686824959i,-0.977052228749259 - 0.212999864544806i,-0.951926616105261 - 0.306326162040378i,-0.918392341909975 - 0.395670957136244i,-0.877084361766975 - 0.480336363753378i,-0.828684159036867 - 0.559716503742171i,-0.773907798836483 - 0.633298285881203i,-0.713494509977684 - 0.700660819677898i,-0.648195922102152 - 0.761473602017917i,-0.578766061056863 - 0.815493621415106i,-0.505952182102922 - 0.862561527907020i,-0.430486498236009 - 0.902597016855528i,-0.353078840029247 - 0.935593572403959i,-0.274410264227140 - 0.961612711483574i,-0.195127610997052 - 0.980777862426851i,-0.115838994396057 - 0.993268003802252i,-0.0371101972928961 - 0.999311179391526i,0.0405380692926983 - 0.999177994622590i,0.116632091743756 - 0.993175188562157i,0.190746320941244 - 0.981639364047398i,0.262503843053827 - 0.964930946950077i,0.331576219971887 - 0.943428434142810i,0.397682767566491 - 0.917522978666288i,0.460589340775468 - 0.887613350037064i,0.520106694092594 - 0.854101297715952i,0.576088484528824 - 0.817387336575068i,0.628428981690776 - 0.777866964828237i,0.677060546441822 - 0.735927317370337i,0.721950935828970 - 0.691944250829266i,0.763100487718403 - 0.646279850872620i,0.800539234017220 - 0.599280347416068i,0.834323986590494 - 0.551274419322850i,0.864535435119085 - 0.502571866923979i,0.891275291280607 - 0.453462628176423i,0.914663508855225 - 0.404216112455513i,0.934835604729082 - 0.355080824786150i,0.951940101347537 - 0.306284252690929i,0.966136107003309 - 0.258032987706010i,0.977591046464943 - 0.210513053922026i,0.986478550882918 - 0.163890416583577i,0.992976512669347 - 0.118311644765099i,0.997265308139778 - 0.0739047033745044i,0.999526188132270 - 0.0307798511655593i,0.999939834574330 + 0.0109693769860702i,0.998685079041845 + 0.0512651236142363i,0.995937777731473 + 0.0900441163391323i,0.991869835931605 + 0.127256546271737i,0.986648374007261 + 0.162864931979936i,0.980435026089629 + 0.196842982137106i,0.973385362059397 + 0.229174468317254i,0.965648423011661 + 0.259852117819139i,0.957366360166733 + 0.288876534909122i,0.948674167123330 + 0.316255157480249i,0.939699495417563 + 0.342001254839770i,0.930562543532330 + 0.366132971165724i,0.921376009778823 + 0.388672418115892i,0.912245099827192 + 0.409644819131496i,0.903267580081342 + 0.429077707151042i,0.894533868559222 + 0.447000176734274i,0.886127155442092 + 0.463442190988376i,0.878123545983241 + 0.478433943183194i,0.870592219009213 + 0.492005272533349i,0.863595594796613 + 0.504185133307086i,0.857189506658938 + 0.515001116186952i,0.851423371125146 + 0.524479020649913i,0.846340352131403 + 0.532642477046370i,0.841977515176557 + 0.539512617032365i,0.838365967908973 + 0.545107791039580i,0.835530984116666 + 0.549443331546608i,0.833492108584129 + 0.552531361035718i,0.832263240758894 + 0.554380643674996i,0.831852695639740 + 0.554996479950006i,0.832263240758894 + 0.554380643674996i,0.833492108584131 + 0.552531361035715i,0.835530984116668 + 0.549443331546605i,0.838365967908973 + 0.545107791039580i,0.841977515176557 + 0.539512617032365i,0.846340352131403 + 0.532642477046370i,0.851423371125146 + 0.524479020649913i,0.857189506658938 + 0.515001116186952i,0.863595594796613 + 0.504185133307086i,0.870592219009211 + 0.492005272533352i,0.878123545983241 + 0.478433943183194i,0.886127155442090 + 0.463442190988379i,0.894533868559222 + 0.447000176734274i,0.903267580081341 + 0.429077707151046i,0.912245099827192 + 0.409644819131496i];
    PilotSequence = [24769.5252109022 + 24769.5252109022i,28486.1974405209 + 5371.10299855758i,24769.5252109022 - 24769.5252109022i,8.49741660046189 - 29807.8583973955i,-24769.5252109022 - 24769.5252109022i,-28449.2649458591 - 28968.3246728757i,-24769.5252109022 - 24769.5252109022i,-28980.8868710102 + 335.605039472830i,-24769.5252109022 + 24769.5252109022i,-796.556170140802 + 29706.0488013873i,24769.5252109022 + 24769.5252109022i,35501.0355563226 + 23498.6614511803i,24769.5252109022 + 24769.5252109022i,-5873.62770928885 + 23975.8165299544i,-24769.5252109022 + 24769.5252109022i,-4968.51796171097 + 30601.8273310245i,24769.5252109022 + 24769.5252109022i,30579.5783232012 - 5866.06831919623i,24769.5252109022 - 24769.5252109022i,23216.9040379714 + 980.826266348245i,24769.5252109022 + 24769.5252109022i,30287.0857177359 + 1165.80754605183i,24769.5252109022 - 24769.5252109022i,-5845.78119687954 - 6002.93435685044i,-24769.5252109022 + 24769.5252109022i,-47.0729903739931 + 29348.8875449107i,24769.5252109022 + 24769.5252109022i,6071.98659579057 + 29306.2594513876i,-24769.5252109022 + 24769.5252109022i,-29647.1983670815 + 561.706213216318i,-24769.5252109022 - 24769.5252109022i,-29082.3653988391 - 35685.3056525300i,-24769.5252109022 - 24769.5252109022i,310.088266102609 + 6239.97917318543i,24769.5252109022 + 24769.5252109022i,29813.2106662932 + 5762.50528801656i,24769.5252109022 - 24769.5252109022i,23517.0909131579 - 36691.8939279368i,24769.5252109022 - 24769.5252109022i,23583.2555018680 + 6813.91038546476i,24769.5252109022 + 24769.5252109022i,30159.5325053458 + 324.765622048863i,24769.5252109022 - 24769.5252109022i,702.410189392815 - 6148.64114106877i,-24769.5252109022 + 24769.5252109022i,-35608.6511072518 + 30510.2685867883i,-24769.5252109022 + 24769.5252109022i,6936.20329234025 + 24296.7442134809i,24769.5252109022 + 24769.5252109022i,172.057358928854 + 24380.3695831998i,-24769.5252109022 + 24769.5252109022i,-6121.62842999977 + 23712.5314949686i,24769.5252109022 + 24769.5252109022i,30522.6039419111 + 29935.1847667739i,24769.5252109022 + 24769.5252109022i,24208.0853812592 + 934.691302482095i,24769.5252109022 - 24769.5252109022i,24636.6408774995 - 34751.2213083765i,24769.5252109022 - 24769.5252109022i,24498.8368133374 + 1077.75567215872i,24769.5252109022 + 24769.5252109022i,24002.3755550000 + 29970.9217374550i,24769.5252109022 + 24769.5252109022i,30856.5720331643 + 23314.3913549729i,24769.5252109022 + 24769.5252109022i,-5110.99376573561 + 23855.5958646452i,-24769.5252109022 + 24769.5252109022i,-5941.51507870943 + 31036.8999656819i,24769.5252109022 + 24769.5252109022i,35662.2412360430 - 5267.53996737791i,24769.5252109022 - 24769.5252109022i,-854.192687789397 - 5860.80801368166i,-24769.5252109022 + 24769.5252109022i,-29966.9734428730 + 36804.8740095482i,-24769.5252109022 + 24769.5252109022i,-23672.3496274365 - 5915.21355113657i,-24769.5252109022 - 24769.5252109022i,-24742.1841868623 - 6229.95516442515i,-24769.5252109022 + 24769.5252109022i,-24862.4968155546 + 35790.9593179526i,-24769.5252109022 + 24769.5252109022i,-23790.8352502508 - 753.321118289096i,-24769.5252109022 - 24769.5252109022i,-29572.9900477944 - 30017.0567013212i,-24769.5252109022 - 24769.5252109022i,-219.130349302849 - 23754.6016773007i,24769.5252109022 - 24769.5252109022i,28971.4698205785 - 24677.6381536952i,24769.5252109022 - 24769.5252109022i,29511.5094607313 - 24678.2267193472i,24769.5252109022 - 24769.5252109022i,-5854.98979697615 - 24000.0335541765i,-24769.5252109022 - 24769.5252109022i,868.765818568113 - 30654.8105014871i,24769.5252109022 - 24769.5252109022i,283.995188864826 + 5033.73226212880i,-24769.5252109022 + 24769.5252109022i,-28.4350780612890 + 4942.77434532904i,24769.5252109022 - 24769.5252109022i,-210.032105265990 - 30875.0934585251i,-24769.5252109022 - 24769.5252109022i,-730.134083957962 - 23837.1847953442i,24769.5252109022 - 24769.5252109022i,5516.46645281225 - 23489.9555842448i,-24769.5252109022 - 24769.5252109022i,-30333.3249067696 - 29687.7419572539i,-24769.5252109022 - 24769.5252109022i,-22839.8173818184 - 168.219420406567i,-24769.5252109022 + 24769.5252109022i,-29674.4685756233 + 28748.2869515261i,-24769.5252109022 + 24769.5252109022i,-1261.43720271418 + 28683.6183005148i,24769.5252109022 + 24769.5252109022i,34817.9622009542 + 87.1322400618913i,24769.5252109022 - 24769.5252109022i,110.307012608607 - 28855.0870937916i,-24769.5252109022 - 24769.5252109022i,-35018.0745226274 - 29479.1322189802i,-24769.5252109022 - 24769.5252109022i,411.897862110755 + 5836.46837161540i,24769.5252109022 + 24769.5252109022i,35511.8749737465 - 891.020957283612i,24769.5252109022 - 24769.5252109022i,-7035.92838499763 - 307.169961411541i,-24769.5252109022 + 24769.5252109022i,904.275946237580 + 105.635272746014i,24769.5252109022 - 24769.5252109022i,1361.49336355080 + 397.220506164501i,-24769.5252109022 + 24769.5252109022i,-6075.49346613362 + 480.042729004076i,24769.5252109022 - 24769.5252109022i,29435.7929419609 - 6503.80985757773i,24769.5252109022 + 24769.5252109022i,30003.9059375347 + 36179.1061036491i,24769.5252109022 + 24769.5252109022i,-4959.43197945852 - 6412.85194077797i,-24769.5252109022 - 24769.5252109022i,-5016.17951773694 + 635.669296815155i,24769.5252109022 + 24769.5252109022i,29646.7446810581 + 115.567318123181i,24769.5252109022 - 24769.5252109022i,28987.9006116963 - 854.799646118003i,24769.5252109022 + 24769.5252109022i,637.753800165916 + 5580.19707731572i,-24769.5252109022 - 24769.5252109022i,-34542.6728790249 - 30226.1507800793i,-24769.5252109022 - 24769.5252109022i,1196.76855170287 - 23362.6108221898i,24769.5252109022 - 24769.5252109022i,29719.1995651738 - 30320.1741429831i,24769.5252109022 - 24769.5252109022i,22669.0597720377 + 6057.67096248459i,24769.5252109022 + 24769.5252109022i,29528.5165557166 - 205.360365403398i,24769.5252109022 - 24769.5252109022i,82.4605001992971 - 7106.40299093004i,-24769.5252109022 + 24769.5252109022i,-29436.1240101402 + 35695.2254361228i,-24769.5252109022 + 24769.5252109022i,-23024.4675933428 + 434.361451161328i,-24769.5252109022 - 24769.5252109022i,-30578.1559562089 - 35026.5719392279i,-24769.5252109022 - 24769.5252109022i,4868.79286905358 + 50.9109288962802i,24769.5252109022 + 24769.5252109022i,4913.52385860407 + 34688.6371607160i,-24769.5252109022 + 24769.5252109022i,-30768.8512274504 - 974.523709158290i,-24769.5252109022 - 24769.5252109022i,-23718.3803661351 - 28746.2024481753i,-24769.5252109022 - 24769.5252109022i,-23772.5284061173 - 28710.2999434045i,-24769.5252109022 - 24769.5252109022i,-30541.0150112121 - 908.947686100173i,-24769.5252109022 + 24769.5252109022i,5699.82917697289 + 34661.7470674911i,24769.5252109022 + 24769.5252109022i,-1048.73202844545 - 296.330543987573i,-24769.5252109022 - 24769.5252109022i,-722.347850853642 - 35400.9793954859i,24769.5252109022 - 24769.5252109022i,6595.59544482559 + 6951.94129263851i,-24769.5252109022 + 24769.5252109022i,-36139.9419642236 - 1036.72774150194i,-24769.5252109022 - 24769.5252109022i,6329.07329875392 - 1102.30376456006i,24769.5252109022 + 24769.5252109022i,-576.383569162571 + 6851.05133046158i,-24769.5252109022 - 24769.5252109022i,102.398161660125 - 35181.8490461831i,24769.5252109022 - 24769.5252109022i,584.182064051311 + 432.381172978103i,-24769.5252109022 + 24769.5252109022i,-6732.26529392914 + 29056.6217824572i,24769.5252109022 + 24769.5252109022i,35795.2815969594 + 29707.5570008705i,24769.5252109022 + 24769.5252109022i,45.6506233817076 - 5061.00247067055i,-24769.5252109022 - 24769.5252109022i,-36114.1983478417 - 5060.09509862375i,-24769.5252109022 + 24769.5252109022i,6201.52008636386 + 30090.1001510888i,24769.5252109022 + 24769.5252109022i,6312.41566462445 + 29706.9684352186i,-24769.5252109022 + 24769.5252109022i,-35958.5717800306 - 6339.32415052591i,-24769.5252109022 - 24769.5252109022i,-255.940226120437 + 40.0592496878966i,24769.5252109022 + 24769.5252109022i,34945.7422563559 + 6367.75922858720i,24769.5252109022 - 24769.5252109022i,-767.078840404131 - 29834.7484906203i,-24769.5252109022 - 24769.5252109022i,-29189.7541067566 - 30246.6463527311i,-24769.5252109022 - 24769.5252109022i,-29691.4756706086 + 5435.75938778448i,-24769.5252109022 + 24769.5252109022i,5453.45927358933 + 6010.00940645862i,24769.5252109022 - 24769.5252109022i,5618.27604882039 - 36006.2333360566i,-24769.5252109022 - 24769.5252109022i,-36753.9630806519 + 14.6773559462537i,-24769.5252109022 + 24769.5252109022i,5819.81073748592 + 35940.6573129985i,24769.5252109022 + 24769.5252109022i,5490.72283643033 - 6074.67805746993i,-24769.5252109022 - 24769.5252109022i,-30205.7716943795 - 5050.16305324658i,-24769.5252109022 + 24769.5252109022i,-29728.6166156055 + 30794.5948438324i,-24769.5252109022 + 24769.5252109022i,6386.50136606744 + 23052.1914879079i,24769.5252109022 + 24769.5252109022i,-395.013384969575 + 29349.2186130900i,-24769.5252109022 + 24769.5252109022i,-6823.22321072890 - 50.8986671118641i,24769.5252109022 - 24769.5252109022i,36618.8504781692 - 29450.1085752669i,24769.5252109022 - 24769.5252109022i,-5892.14300375739 - 22770.5382998666i,-24769.5252109022 - 24769.5252109022i,-5882.72595332571 - 29862.5950030296i,24769.5252109022 - 24769.5252109022i,36608.0110607452 - 789.542429454707i,24769.5252109022 + 24769.5252109022i,-6878.79361770335 + 35456.8808706396i,-24769.5252109022 + 24769.5252109022i,-221.202590869195 - 7041.74660170314i,24769.5252109022 - 24769.5252109022i,7034.17494982611 + 151.788629288791i,-24769.5252109022 + 24769.5252109022i,-35301.2543028285 + 6962.78071006248i,-24769.5252109022 - 24769.5252109022i,593.268046303753 - 36543.3424097339i,24769.5252109022 - 24769.5252109022i,28926.8614488722 + 5478.71854948681i,24769.5252109022 + 24769.5252109022i,28486.1974405209 + 5371.10299855758i,24769.5252109022 - 24769.5252109022i,8.49741660046189 - 29807.8583973955i,-24769.5252109022 - 24769.5252109022i,-28449.2649458591 - 28968.3246728757i,-24769.5252109022 - 24769.5252109022i,-28980.8868710102 + 335.605039472830i,-24769.5252109022 + 24769.5252109022i,-796.556170140802 + 29706.0488013873i,24769.5252109022 + 24769.5252109022i,35501.0355563226 + 23498.6614511803i,24769.5252109022 + 24769.5252109022i,-5873.62770928885 + 23975.8165299544i,-24769.5252109022 + 24769.5252109022i,-4968.51796171097 + 30601.8273310245i,24769.5252109022 + 24769.5252109022i,30579.5783232012 - 5866.06831919623i,24769.5252109022 - 24769.5252109022i,23216.9040379714 + 980.826266348245i,24769.5252109022 + 24769.5252109022i,30287.0857177359 + 1165.80754605183i,24769.5252109022 - 24769.5252109022i,-5845.78119687954 - 6002.93435685044i,-24769.5252109022 + 24769.5252109022i,-47.0729903739931 + 29348.8875449107i,24769.5252109022 + 24769.5252109022i,6071.98659579057 + 29306.2594513876i,-24769.5252109022 + 24769.5252109022i,-29647.1983670815 + 561.706213216318i,-24769.5252109022 - 24769.5252109022i,-29082.3653988391 - 35685.3056525300i,-24769.5252109022 - 24769.5252109022i,310.088266102609 + 6239.97917318543i,24769.5252109022 + 24769.5252109022i,29813.2106662932 + 5762.50528801656i,24769.5252109022 - 24769.5252109022i,23517.0909131579 - 36691.8939279368i,24769.5252109022 - 24769.5252109022i,23583.2555018680 + 6813.91038546476i,24769.5252109022 + 24769.5252109022i,30159.5325053458 + 324.765622048863i,24769.5252109022 - 24769.5252109022i,702.410189392815 - 6148.64114106877i,-24769.5252109022 + 24769.5252109022i,-35608.6511072518 + 30510.2685867883i,-24769.5252109022 + 24769.5252109022i,6936.20329234025 + 24296.7442134809i,24769.5252109022 + 24769.5252109022i,172.057358928854 + 24380.3695831998i,-24769.5252109022 + 24769.5252109022i,-6121.62842999977 + 23712.5314949686i,24769.5252109022 + 24769.5252109022i,30522.6039419111 + 29935.1847667739i,24769.5252109022 + 24769.5252109022i,24208.0853812592 + 934.691302482095i,24769.5252109022 - 24769.5252109022i,24636.6408774995 - 34751.2213083765i,24769.5252109022 - 24769.5252109022i,24498.8368133374 + 1077.75567215872i,24769.5252109022 + 24769.5252109022i,24002.3755550000 + 29970.9217374550i,24769.5252109022 + 24769.5252109022i,30856.5720331643 + 23314.3913549729i,24769.5252109022 + 24769.5252109022i,-5110.99376573561 + 23855.5958646452i,-24769.5252109022 + 24769.5252109022i,-5941.51507870943 + 31036.8999656819i,24769.5252109022 + 24769.5252109022i,35662.2412360430 - 5267.53996737791i,24769.5252109022 - 24769.5252109022i,-854.192687789397 - 5860.80801368166i,-24769.5252109022 + 24769.5252109022i,-29966.9734428730 + 36804.8740095482i,-24769.5252109022 + 24769.5252109022i,-23672.3496274365 - 5915.21355113657i,-24769.5252109022 - 24769.5252109022i,-24742.1841868623 - 6229.95516442515i,-24769.5252109022 + 24769.5252109022i,-24862.4968155546 + 35790.9593179526i,-24769.5252109022 + 24769.5252109022i,-23790.8352502508 - 753.321118289096i,-24769.5252109022 - 24769.5252109022i,-29572.9900477944 - 30017.0567013212i,-24769.5252109022 - 24769.5252109022i,-219.130349302849 - 23754.6016773007i,24769.5252109022 - 24769.5252109022i,28971.4698205785 - 24677.6381536952i,24769.5252109022 - 24769.5252109022i,29511.5094607313 - 24678.2267193472i,24769.5252109022 - 24769.5252109022i,-5854.98979697615 - 24000.0335541765i,-24769.5252109022 - 24769.5252109022i,868.765818568113 - 30654.8105014871i,24769.5252109022 - 24769.5252109022i,283.995188864826 + 5033.73226212880i,-24769.5252109022 + 24769.5252109022i,-28.4350780612890 + 4942.77434532904i,24769.5252109022 - 24769.5252109022i,-210.032105265990 - 30875.0934585251i,-24769.5252109022 - 24769.5252109022i,-730.134083957962 - 23837.1847953442i,24769.5252109022 - 24769.5252109022i,5516.46645281225 - 23489.9555842448i,-24769.5252109022 - 24769.5252109022i,-30333.3249067696 - 29687.7419572539i,-24769.5252109022 - 24769.5252109022i,-22839.8173818184 - 168.219420406567i,-24769.5252109022 + 24769.5252109022i,-29674.4685756233 + 28748.2869515261i,-24769.5252109022 + 24769.5252109022i,-1261.43720271418 + 28683.6183005148i,24769.5252109022 + 24769.5252109022i,34817.9622009542 + 87.1322400618913i,24769.5252109022 - 24769.5252109022i,110.307012608607 - 28855.0870937916i,-24769.5252109022 - 24769.5252109022i,-35018.0745226274 - 29479.1322189802i,-24769.5252109022 - 24769.5252109022i,411.897862110755 + 5836.46837161540i,24769.5252109022 + 24769.5252109022i,35511.8749737465 - 891.020957283612i,24769.5252109022 - 24769.5252109022i,-7035.92838499763 - 307.169961411541i,-24769.5252109022 + 24769.5252109022i,904.275946237580 + 105.635272746014i,24769.5252109022 - 24769.5252109022i,1361.49336355080 + 397.220506164501i,-24769.5252109022 + 24769.5252109022i,-6075.49346613362 + 480.042729004076i,24769.5252109022 - 24769.5252109022i,29435.7929419609 - 6503.80985757773i,24769.5252109022 + 24769.5252109022i,30003.9059375347 + 36179.1061036491i,24769.5252109022 + 24769.5252109022i,-4959.43197945852 - 6412.85194077797i,-24769.5252109022 - 24769.5252109022i,-5016.17951773694 + 635.669296815155i,24769.5252109022 + 24769.5252109022i,29646.7446810581 + 115.567318123181i,24769.5252109022 - 24769.5252109022i,28987.9006116963 - 854.799646118003i,24769.5252109022 + 24769.5252109022i,637.753800165916 + 5580.19707731572i,-24769.5252109022 - 24769.5252109022i,-34542.6728790249 - 30226.1507800793i,-24769.5252109022 - 24769.5252109022i,1196.76855170287 - 23362.6108221898i,24769.5252109022 - 24769.5252109022i,29719.1995651738 - 30320.1741429831i,24769.5252109022 - 24769.5252109022i,22669.0597720377 + 6057.67096248459i,24769.5252109022 + 24769.5252109022i,29528.5165557166 - 205.360365403398i,24769.5252109022 - 24769.5252109022i,82.4605001992971 - 7106.40299093004i,-24769.5252109022 + 24769.5252109022i,-29436.1240101402 + 35695.2254361228i,-24769.5252109022 + 24769.5252109022i,-23024.4675933428 + 434.361451161328i,-24769.5252109022 - 24769.5252109022i,-30578.1559562089 - 35026.5719392279i,-24769.5252109022 - 24769.5252109022i,4868.79286905358 + 50.9109288962802i,24769.5252109022 + 24769.5252109022i,4913.52385860407 + 34688.6371607160i,-24769.5252109022 + 24769.5252109022i,-30768.8512274504 - 974.523709158290i,-24769.5252109022 - 24769.5252109022i,-23718.3803661351 - 28746.2024481753i,-24769.5252109022 - 24769.5252109022i,-23772.5284061173 - 28710.2999434045i,-24769.5252109022 - 24769.5252109022i,-30541.0150112121 - 908.947686100173i,-24769.5252109022 + 24769.5252109022i,5699.82917697289 + 34661.7470674911i,24769.5252109022 + 24769.5252109022i,-1048.73202844545 - 296.330543987573i,-24769.5252109022 - 24769.5252109022i,-722.347850853642 - 35400.9793954859i,24769.5252109022 - 24769.5252109022i,6595.59544482559 + 6951.94129263851i,-24769.5252109022 + 24769.5252109022i,-36139.9419642236 - 1036.72774150194i,-24769.5252109022 - 24769.5252109022i,6329.07329875392 - 1102.30376456006i,24769.5252109022 + 24769.5252109022i,-576.383569162571 + 6851.05133046158i,-24769.5252109022 - 24769.5252109022i,102.398161660125 - 35181.8490461831i,24769.5252109022 - 24769.5252109022i,584.182064051311 + 432.381172978103i,-24769.5252109022 + 24769.5252109022i,-6732.26529392914 + 29056.6217824572i,24769.5252109022 + 24769.5252109022i,35795.2815969594 + 29707.5570008705i,24769.5252109022 + 24769.5252109022i,45.6506233817076 - 5061.00247067055i,-24769.5252109022 - 24769.5252109022i,-36114.1983478417 - 5060.09509862375i,-24769.5252109022 + 24769.5252109022i,6201.52008636386 + 30090.1001510888i,24769.5252109022 + 24769.5252109022i,6312.41566462445 + 29706.9684352186i,-24769.5252109022 + 24769.5252109022i,-35958.5717800306 - 6339.32415052591i,-24769.5252109022 - 24769.5252109022i,-255.940226120437 + 40.0592496878966i,24769.5252109022 + 24769.5252109022i,34945.7422563559 + 6367.75922858720i,24769.5252109022 - 24769.5252109022i,-767.078840404131 - 29834.7484906203i,-24769.5252109022 - 24769.5252109022i,-29189.7541067566 - 30246.6463527311i,-24769.5252109022 - 24769.5252109022i,-29691.4756706086 + 5435.75938778448i,-24769.5252109022 + 24769.5252109022i,5453.45927358933 + 6010.00940645862i,24769.5252109022 - 24769.5252109022i,5618.27604882039 - 36006.2333360566i,-24769.5252109022 - 24769.5252109022i,-36753.9630806519 + 14.6773559462537i,-24769.5252109022 + 24769.5252109022i,5819.81073748592 + 35940.6573129985i,24769.5252109022 + 24769.5252109022i,5490.72283643033 - 6074.67805746993i,-24769.5252109022 - 24769.5252109022i,-30205.7716943795 - 5050.16305324658i,-24769.5252109022 + 24769.5252109022i,-29728.6166156055 + 30794.5948438324i,-24769.5252109022 + 24769.5252109022i,6386.50136606744 + 23052.1914879079i,24769.5252109022 + 24769.5252109022i,-395.013384969575 + 29349.2186130900i,-24769.5252109022 + 24769.5252109022i,-6823.22321072890 - 50.8986671118641i,24769.5252109022 - 24769.5252109022i,36618.8504781692 - 29450.1085752669i,24769.5252109022 - 24769.5252109022i,-5892.14300375739 - 22770.5382998666i,-24769.5252109022 - 24769.5252109022i,-5882.72595332571 - 29862.5950030296i,24769.5252109022 - 24769.5252109022i,36608.0110607452 - 789.542429454707i,24769.5252109022 + 24769.5252109022i,-6878.79361770335 + 35456.8808706396i,-24769.5252109022 + 24769.5252109022i,-221.202590869195 - 7041.74660170314i,24769.5252109022 - 24769.5252109022i,7034.17494982611 + 151.788629288791i,-24769.5252109022 + 24769.5252109022i,-35301.2543028285 + 6962.78071006248i,-24769.5252109022 - 24769.5252109022i,593.268046303753 - 36543.3424097339i,24769.5252109022 - 24769.5252109022i,28926.8614488722 + 5478.71854948681i].';
    AzimuthScanAngles = (-30:0.5:30).';
    [~, doaImplement]  = DoaEstimatorMUSICSignalImplement(recStvPartition, waveformRx, PilotSequence, AzimuthScanAngles, 1, 1);
    if abs(doaImplement - doa(1,1)) > 0.5
        error('Implementation is inconsistent with simulation!')
    end
    
    [~, doaImplement]  = DoaEstimatorMUSICSignalImplement_mex(recStvPartition, waveformRx, PilotSequence, AzimuthScanAngles, 1, 1);
    if abs(doaImplement - doa(1,1)) > 0.5
        error('Mex Implementation is inconsistent with simulation!')
    end
end

cd(CurrentDirectory);