% /*!
%  *  @brief     This script is used to test the correlation character between raw FPGA pilot sequence and DSP local pilot sequence and adaptive weight calculated directivity.
%  *  @details
%  *  @pre       .
%  *  @bug      Null
%  *  @warning  Null
%  *  @author    Collus Wang
%  *  @version   1.0
%  *  @date      2017.10.30
%  *  @copyright Collus Wang all rights reserved.
%  *  @remark   { revision history: V1.0, 2017.10.13. Collus Wang, first draft.}
%  *  @remark   { revision history: V1.01, 2017.12.12. Collus Wang, ananlyze the oversampling synchronization effect.}
%  */

clc
clear
close all

PilotFPGA = zeros(512, 4, 10);

FilePath = 'RawData/20171206_PilotFPGA/OutdoorDegree0/';
% FilePath = 'RawData/20171030_PilotFPGA/7Degree_80dBm/';
% FilePath = 'RawData/20171117_PilotFPGA/Outdoor10/';
% FilePath = 'RawData/20171117_PilotFPGADelayWeight/Outdoor10/';
PilotI1 = load([FilePath,'1/PilotIFPGA.dat']);
PilotQ1 = load([FilePath,'1/PilotQFPGA.dat']);
PilotI2 = load([FilePath,'2/PilotIFPGA.dat']);
PilotQ2 = load([FilePath,'2/PilotQFPGA.dat']);
PilotI3 = load([FilePath,'3/PilotIFPGA.dat']);
PilotQ3 = load([FilePath,'3/PilotQFPGA.dat']);
PilotI4 = load([FilePath,'4/PilotIFPGA.dat']);
PilotQ4 = load([FilePath,'4/PilotQFPGA.dat']);
PilotI5 = load([FilePath,'5/PilotIFPGA.dat']);
PilotQ5 = load([FilePath,'5/PilotQFPGA.dat']);
PilotI6 = load([FilePath,'6/PilotIFPGA.dat']);
PilotQ6 = load([FilePath,'6/PilotQFPGA.dat']);
PilotI7 = load([FilePath,'7/PilotIFPGA.dat']);
PilotQ7 = load([FilePath,'7/PilotQFPGA.dat']);
PilotI8 = load([FilePath,'8/PilotIFPGA.dat']);
PilotQ8 = load([FilePath,'8/PilotQFPGA.dat']);
PilotI9 = load([FilePath,'9/PilotIFPGA.dat']);
PilotQ9 = load([FilePath,'9/PilotQFPGA.dat']);
PilotI10 = load([FilePath,'10/PilotIFPGA.dat']);
PilotQ10 = load([FilePath,'10/PilotQFPGA.dat']);

PilotFPGA(:,:,1) = reshape(PilotI1 + 1i*PilotQ1, 512, 4);
PilotFPGA(:,:,2) = reshape(PilotI2 + 1i*PilotQ2, 512, 4);
PilotFPGA(:,:,3) = reshape(PilotI3 + 1i*PilotQ3, 512, 4);
PilotFPGA(:,:,4) = reshape(PilotI4 + 1i*PilotQ4, 512, 4);
PilotFPGA(:,:,5) = reshape(PilotI5 + 1i*PilotQ5, 512, 4);
PilotFPGA(:,:,6) = reshape(PilotI6 + 1i*PilotQ6, 512, 4);
PilotFPGA(:,:,7) = reshape(PilotI7 + 1i*PilotQ7, 512, 4);
PilotFPGA(:,:,8) = reshape(PilotI8 + 1i*PilotQ8, 512, 4);
PilotFPGA(:,:,9) = reshape(PilotI9 + 1i*PilotQ9, 512, 4);
PilotFPGA(:,:,10) = reshape(PilotI10 + 1i*PilotQ10, 512, 4);

%RRC
% PilotSequence = [19586.4807256988 + 29466.9640130799i,27282.4458466635 + 4296.28538105664i,25927.7882217441 - 28511.4389428432i,167.504842995024 - 26635.4995925915i,-26153.4347765781 - 19592.2127771560i,-27290.5521915745 - 27484.6851015768i,-19226.5760218596 - 26199.9065676545i,-27307.0487611793 + 479.534603935006i,-26833.3773304358 + 25965.7075568437i,1263.98405253467 + 26966.6138171165i,23992.0853937425 + 21534.9960167912i,30264.3284052634 + 22969.4524199012i,26437.0831227048 + 23406.9163394201i,-3598.49166991571 + 22922.3914603402i,-29044.2176145776 + 22232.7693667276i,-4403.81918618314 + 26050.1473658537i,28699.4033928644 + 27749.0213535867i,26429.7484006674 - 2603.80056737191i,20716.1176193010 - 31900.7348694145i,24840.4001229471 + 79.5573091505895i,21281.0805332639 + 33085.7396898442i,25560.6518791333 - 480.789840045645i,29050.5326037051 - 30863.5762216335i,-4012.73392378957 - 3605.34277871604i,-31108.9392491841 + 28021.1366580832i,277.492487759858 + 26648.1007007313i,30580.2969003973 + 19457.5308578097i,4175.84149762259 + 27666.4484518480i,-28453.3165087980 + 26524.5835877239i,-26549.7901210757 - 1085.50109086555i,-19632.9494753613 - 24172.4463089337i,-27466.8558741023 - 30183.8470530822i,-26261.3096735278 - 26614.3073263274i,596.005604145086 + 3865.93008203209i,25902.5769278570 + 29475.7395060784i,26895.8553474988 + 3557.18070969421i,21839.9565641441 - 26883.2473946789i,22639.9955945125 - 29538.3266497378i,23666.1948495142 - 26221.9426253965i,22922.4846531982 + 2508.26856862138i,21527.9845438733 + 31688.7037109494i,27116.8887344010 + 382.054874451979i,26434.0396811635 - 31725.4480464666i,-395.389338697558 - 3123.12708794277i,-24871.7332692035 + 28008.2998636809i,-29812.5387488956 + 26240.1102538939i,-26486.5983553225 + 21657.6582682783i,3266.55089642689 + 23615.8767939683i,31116.7019513432 + 23499.7767895920i,455.360376566079 + 22244.2815145482i,-31533.0674634162 + 23634.0765045876i,-3481.00343381699 + 23276.4856099153i,28283.8306760230 + 21156.5498398179i,26096.1846377128 + 27298.3273434054i,21454.1136684882 + 26178.1594442360i,24007.9857440638 - 156.526724320932i,22957.5737898870 - 24720.3124213801i,22641.6185839782 - 30317.7185936199i,23953.3763048252 - 24715.3731651545i,22467.2626321829 - 111.336073733488i,23021.8520457307 + 26298.5680079995i,24087.5430532144 + 27074.2451163099i,21005.1948892963 + 21400.3171388588i,26722.4298905473 + 23049.9337720824i,28362.8415409533 + 23110.0733258517i,-4210.37877080272 + 23321.6762605028i,-29169.7002705843 + 21805.9008385428i,-3605.86465872092 + 26268.5928587757i,26409.2491162037 + 28442.5103650976i,30358.5277461444 - 3825.64280951248i,24247.8307946523 - 30000.5598113574i,801.849988927220 - 2732.96586857982i,-26585.7494633105 + 26112.4091440493i,-27257.4407691220 + 29924.1837927968i,-20774.8980125602 + 26596.5556070109i,-23834.6534799703 - 3483.87520758011i,-23173.2039548383 - 29420.7953495921i,-22456.2845135088 - 3973.37069430058i,-24065.5324987865 + 26724.5677056044i,-22446.5207694614 + 30126.7477889768i,-23420.1079654478 + 24282.7036467967i,-23482.7386095364 + 984.312285633552i,-21108.4823202318 - 26671.2851749296i,-27075.2688040118 - 27310.3291497814i,-26062.5390798062 - 20754.7577695025i,-177.867888806222 - 23857.7108267793i,26024.1990157793 - 23269.5458101578i,27391.8341896645 - 22288.3710556748i,19829.4552295081 - 24121.2694505044i,26339.1197799847 - 22527.0021216426i,28301.3066404764 - 22932.8491222291i,-3700.37296976957 - 24157.5681667263i,-30739.7034874015 - 20992.0691605704i,-558.590105388595 - 26618.7915468858i,32678.9424660013 - 28255.6276446316i,701.591678539087 + 3861.72565039937i,-33369.3880359709 + 29453.3486167110i,175.611187905997 + 3443.58793506050i,33009.4833321317 - 27858.5548349340i,-618.463649190271 - 26782.4941212738i,-32412.6910075657 - 21375.1028035579i,91.1347295885261 - 23389.8468361403i,31317.9269661079 - 23420.1079654478i,3279.97855353048 - 22574.3720513713i,-28732.8285319771 - 22069.0155854099i,-25339.5252993730 - 26577.5737795223i,-21898.7369574034 - 26031.5926930481i,-24018.2713681160 - 766.790835742216i,-20688.3495101018 + 26893.4645178811i,-27235.0759169348 + 26712.3758149038i,-26316.9776865299 + 19625.8447324161i,430.448491882561 + 27262.9592200527i,24113.4378096295 + 26103.2098807096i,30924.7023164390 - 117.163494831940i,24552.1333827913 - 25822.2501444988i,-163.609381530024 - 27479.6885306509i,-24174.8317912610 - 19901.0724171697i,-31193.3959646661 - 26141.3752883003i,-24375.4738683554 - 28392.5744035526i,264.891379620039 + 3640.30873904303i,24619.6892690490 + 30891.4132695485i,30361.8081347465 + 352.745720606459i,25759.8981174788 - 32568.9852143129i,-2624.60121328072 - 655.145791841004i,-31355.8432597936 + 33015.2153835889i,-748.961608267788 + 204.186985645756i,33537.3470789519 - 33238.1733285070i,-452.906536927745 + 478.842109313146i,-31095.7476231564 + 33012.5267736730i,-3244.91940034547 - 869.927371706716i,27647.6054060240 - 31147.2245677602i,26878.2576684331 - 2758.99463382324i,19620.5364513001 + 26519.2063678922i,27249.3344242110 + 29352.2592231626i,27948.3059462628 + 26170.7657669673i,-3997.68327722025 - 2340.85691848437i,-28855.4634107388 - 31343.7303219071i,-4364.95776439115 - 1002.37306151674i,28318.7035281674 + 33602.2143552937i,26930.8213078258 - 292.774682737937i,19080.2292662794 - 33109.2234606178i,27979.6402560406 + 824.505172710513i,26037.8144121483 + 30812.3993632043i,-691.537602895615 + 3242.97166961297i,-24142.2237786913 - 28016.7205250540i,-30618.1910064298 - 26257.0154383377i,-24666.5817890526 - 21101.6026419177i,120.134913266323 - 24358.1844321739i,26079.8670287815 - 21770.3041298826i,27027.6085426869 - 25278.5305738026i,21278.0370917226 - 28930.1240399417i,23321.6762605027 + 3551.72104195085i,22068.2917288941 + 31846.8694010694i,25827.3977966278 - 986.260016366053i,26808.6526627779 - 30649.8175400550i,250.632872343841 - 3377.36509015549i,-26980.0789176414 + 26099.1485793058i,-26073.7265926676 + 30533.6170540455i,-21500.2164346741 + 24206.0782641938i,-23948.8455563678 + 698.311289936982i,-21355.3863308413 - 24619.0313098350i,-26247.4832426992 - 31360.9008076611i,-28316.0149182515 - 23705.6277949473i,3621.74615546284 - 588.922946935994i,29634.9230560610 + 24605.8396838073i,3414.27878121498 + 31179.1374573899i,-27963.4379943792 + 23528.8243202520i,-26600.9623194114 + 1072.89998272573i,-21534.2721602754 - 26409.2491162037i,-23385.9513746753 - 27825.5630701492i,-23035.3467993470 - 18680.8916170071i,-23093.6985719422 - 27709.6139499440i,-22093.1481911557 - 26451.7944418939i,-26028.0140620753 + 1116.75797544357i,-27765.5595487443 + 23743.9678589742i,2605.05580348255 + 30818.5169402812i,31695.5833892636 + 24865.1181939014i,174.355951795357 - 557.666062357977i,-33403.4437615722 - 24468.4691545450i,738.505369598578 - 30286.7864503086i,31329.5228636260 - 25796.5765556941i,2535.32102156667 + 2648.91379620039i,-26189.8242804699 + 31247.0336349622i,-29558.6254879496 + 834.961411379725i,-26230.4291840715 - 33799.3141989620i,2592.74502693885 + 791.103418661886i,30936.3410361521 + 31222.3089673042i,1299.45182055866 + 2727.73774924522i,-33536.5299524089 - 25942.8543725586i,-92.4831585571802 - 30108.9185615024i,33802.7814108445 - 24431.7248190278i,-1498.81284989555 - 831.065949914725i,-30984.2737197205 + 26105.0813640825i,-2462.55603802906 + 27930.6473368462i,25486.9352722999 + 19099.2218824801i,30511.1590090003 + 26952.9546116042i,24982.4143774078 + 28496.7306650681i,-459.757645728080 - 4547.01144625849i,-24197.8917916935 - 28761.3863949940i,-30783.7481186923 - 3952.57004839177i,-26455.7209072801 + 27583.3271501804i,4148.98188220658 + 27645.7474506104i,28792.0438474286 + 19464.9904323802i,4224.00356664442 + 26714.3235456363i,-26415.1160036786 + 28467.6588030967i,-30916.1938085023 - 4323.33783400194i,-23845.3148678211 - 30813.6402600886i,-888.258406878143 + 160.328992927919i,24762.9236443721 + 30713.8311928866i,31206.4988805029 + 4147.72664609594i,23599.2279837547 - 28155.8185774296i,945.972743846440 - 26996.1201097002i,-25877.8522601991 - 19473.4110937533i,-28472.7996558173 - 27261.0114893202i,-18883.7235121325 - 28252.1604327491i,-26723.3539335779 + 4592.43364525470i,-28867.7862061866 + 28948.3380541758i,5004.12886663221 + 3590.58246374284i,29079.0904667220 - 26075.6648085321i,2948.86432900543 - 30877.3323867103i,-25891.0438862269 - 24302.7749511387i,-30513.1067397328 - 213.950729693108i,-25917.7089759734 + 24624.7633612922i,3086.21339688328 + 30833.4743939925i,29325.9944773315 + 25728.9517307206i,4505.10118427316 - 3039.99905859396i,-28507.5368087685 - 29391.8796135358i,-26895.7621546408 - 4449.53171677547i,-19754.4397686799 + 28929.7692083163i,-26942.8231142017 + 26137.1708566675i,-27809.7634588321 + 21257.8968486648i,3588.63473301034 + 24253.1001654769i,31183.2450467616 + 21204.1003190355i,-58.1164999940358 + 26157.1793632832i,-31623.6113699766 + 26895.3360012540i,-2880.69375336792 - 257.808722410947i,26671.2192776277 - 26598.0722587583i,29202.9083489088 - 26078.3554102384i,26811.6961043192 - 21820.2400914276i,-3073.11048104646 - 23481.4833734258i,-30260.2620917927 - 21508.2680711568i,-3157.89590953166 - 26581.8778558263i,26870.1216659530 - 26817.5629917940i,29105.4286194258 + 512.552833529498i,26662.3748459134 + 25122.1703889974i,-2770.70610860309 + 29372.2677297783i,-31769.8891868411 + 26658.0246101860i,88.5876970921806 - 3081.21682595744i,31351.9826917092 - 31615.9145651194i,3246.86713107798 + 178.984769366117i,-26712.3108074584 + 31637.5268525202i,-29504.7134195883 + 2746.39352568342i,-24600.7655915640 - 26236.6509031717i,-1092.67694093266 - 29656.0120245747i,27004.8035852993 - 26505.5909715232i,26880.8047009295 + 3083.16455668994i,19586.4807256988 + 29466.9640130799i,27282.4458466635 + 4296.28538105664i,25927.7882217441 - 28511.4389428432i,167.504842995024 - 26635.4995925915i,-26153.4347765781 - 19592.2127771560i,-27290.5521915745 - 27484.6851015768i,-19226.5760218596 - 26199.9065676545i,-27307.0487611793 + 479.534603935006i,-26833.3773304358 + 25965.7075568437i,1263.98405253467 + 26966.6138171165i,23992.0853937425 + 21534.9960167912i,30264.3284052634 + 22969.4524199012i,26437.0831227048 + 23406.9163394201i,-3598.49166991571 + 22922.3914603402i,-29044.2176145776 + 22232.7693667276i,-4403.81918618314 + 26050.1473658537i,28699.4033928644 + 27749.0213535867i,26429.7484006674 - 2603.80056737191i,20716.1176193010 - 31900.7348694145i,24840.4001229471 + 79.5573091505895i,21281.0805332639 + 33085.7396898442i,25560.6518791333 - 480.789840045645i,29050.5326037051 - 30863.5762216335i,-4012.73392378957 - 3605.34277871604i,-31108.9392491841 + 28021.1366580832i,277.492487759858 + 26648.1007007313i,30580.2969003973 + 19457.5308578097i,4175.84149762259 + 27666.4484518480i,-28453.3165087980 + 26524.5835877239i,-26549.7901210757 - 1085.50109086555i,-19632.9494753613 - 24172.4463089337i,-27466.8558741023 - 30183.8470530822i,-26261.3096735278 - 26614.3073263274i,596.005604145086 + 3865.93008203209i,25902.5769278570 + 29475.7395060784i,26895.8553474988 + 3557.18070969421i,21839.9565641441 - 26883.2473946789i,22639.9955945125 - 29538.3266497378i,23666.1948495142 - 26221.9426253965i,22922.4846531982 + 2508.26856862138i,21527.9845438733 + 31688.7037109494i,27116.8887344010 + 382.054874451979i,26434.0396811635 - 31725.4480464666i,-395.389338697558 - 3123.12708794277i,-24871.7332692035 + 28008.2998636809i,-29812.5387488956 + 26240.1102538939i,-26486.5983553225 + 21657.6582682783i,3266.55089642689 + 23615.8767939683i,31116.7019513432 + 23499.7767895920i,455.360376566079 + 22244.2815145482i,-31533.0674634162 + 23634.0765045876i,-3481.00343381699 + 23276.4856099153i,28283.8306760230 + 21156.5498398179i,26096.1846377128 + 27298.3273434054i,21454.1136684882 + 26178.1594442360i,24007.9857440638 - 156.526724320932i,22957.5737898870 - 24720.3124213801i,22641.6185839782 - 30317.7185936199i,23953.3763048252 - 24715.3731651545i,22467.2626321829 - 111.336073733488i,23021.8520457307 + 26298.5680079995i,24087.5430532144 + 27074.2451163099i,21005.1948892963 + 21400.3171388588i,26722.4298905473 + 23049.9337720824i,28362.8415409533 + 23110.0733258517i,-4210.37877080272 + 23321.6762605028i,-29169.7002705843 + 21805.9008385428i,-3605.86465872092 + 26268.5928587757i,26409.2491162037 + 28442.5103650976i,30358.5277461444 - 3825.64280951248i,24247.8307946523 - 30000.5598113574i,801.849988927220 - 2732.96586857982i,-26585.7494633105 + 26112.4091440493i,-27257.4407691220 + 29924.1837927968i,-20774.8980125602 + 26596.5556070109i,-23834.6534799703 - 3483.87520758011i,-23173.2039548383 - 29420.7953495921i,-22456.2845135088 - 3973.37069430058i,-24065.5324987865 + 26724.5677056044i,-22446.5207694614 + 30126.7477889768i,-23420.1079654478 + 24282.7036467967i,-23482.7386095364 + 984.312285633552i,-21108.4823202318 - 26671.2851749296i,-27075.2688040118 - 27310.3291497814i,-26062.5390798062 - 20754.7577695025i,-177.867888806222 - 23857.7108267793i,26024.1990157793 - 23269.5458101578i,27391.8341896645 - 22288.3710556748i,19829.4552295081 - 24121.2694505044i,26339.1197799847 - 22527.0021216426i,28301.3066404764 - 22932.8491222291i,-3700.37296976957 - 24157.5681667263i,-30739.7034874015 - 20992.0691605704i,-558.590105388595 - 26618.7915468858i,32678.9424660013 - 28255.6276446316i,701.591678539087 + 3861.72565039937i,-33369.3880359709 + 29453.3486167110i,175.611187905997 + 3443.58793506050i,33009.4833321317 - 27858.5548349340i,-618.463649190271 - 26782.4941212738i,-32412.6910075657 - 21375.1028035579i,91.1347295885261 - 23389.8468361403i,31317.9269661079 - 23420.1079654478i,3279.97855353048 - 22574.3720513713i,-28732.8285319771 - 22069.0155854099i,-25339.5252993730 - 26577.5737795223i,-21898.7369574034 - 26031.5926930481i,-24018.2713681160 - 766.790835742216i,-20688.3495101018 + 26893.4645178811i,-27235.0759169348 + 26712.3758149038i,-26316.9776865299 + 19625.8447324161i,430.448491882561 + 27262.9592200527i,24113.4378096295 + 26103.2098807096i,30924.7023164390 - 117.163494831940i,24552.1333827913 - 25822.2501444988i,-163.609381530024 - 27479.6885306509i,-24174.8317912610 - 19901.0724171697i,-31193.3959646661 - 26141.3752883003i,-24375.4738683554 - 28392.5744035526i,264.891379620039 + 3640.30873904303i,24619.6892690490 + 30891.4132695485i,30361.8081347465 + 352.745720606459i,25759.8981174788 - 32568.9852143129i,-2624.60121328072 - 655.145791841004i,-31355.8432597936 + 33015.2153835889i,-748.961608267788 + 204.186985645756i,33537.3470789519 - 33238.1733285070i,-452.906536927745 + 478.842109313146i,-31095.7476231564 + 33012.5267736730i,-3244.91940034547 - 869.927371706716i,27647.6054060240 - 31147.2245677602i,26878.2576684331 - 2758.99463382324i,19620.5364513001 + 26519.2063678922i,27249.3344242110 + 29352.2592231626i,27948.3059462628 + 26170.7657669673i,-3997.68327722025 - 2340.85691848437i,-28855.4634107388 - 31343.7303219071i,-4364.95776439115 - 1002.37306151674i,28318.7035281674 + 33602.2143552937i,26930.8213078258 - 292.774682737937i,19080.2292662794 - 33109.2234606178i,27979.6402560406 + 824.505172710513i,26037.8144121483 + 30812.3993632043i,-691.537602895615 + 3242.97166961297i,-24142.2237786913 - 28016.7205250540i,-30618.1910064298 - 26257.0154383377i,-24666.5817890526 - 21101.6026419177i,120.134913266323 - 24358.1844321739i,26079.8670287815 - 21770.3041298826i,27027.6085426869 - 25278.5305738026i,21278.0370917226 - 28930.1240399417i,23321.6762605027 + 3551.72104195085i,22068.2917288941 + 31846.8694010694i,25827.3977966278 - 986.260016366053i,26808.6526627779 - 30649.8175400550i,250.632872343841 - 3377.36509015549i,-26980.0789176414 + 26099.1485793058i,-26073.7265926676 + 30533.6170540455i,-21500.2164346741 + 24206.0782641938i,-23948.8455563678 + 698.311289936982i,-21355.3863308413 - 24619.0313098350i,-26247.4832426992 - 31360.9008076611i,-28316.0149182515 - 23705.6277949473i,3621.74615546284 - 588.922946935994i,29634.9230560610 + 24605.8396838073i,3414.27878121498 + 31179.1374573899i,-27963.4379943792 + 23528.8243202520i,-26600.9623194114 + 1072.89998272573i,-21534.2721602754 - 26409.2491162037i,-23385.9513746753 - 27825.5630701492i,-23035.3467993470 - 18680.8916170071i,-23093.6985719422 - 27709.6139499440i,-22093.1481911557 - 26451.7944418939i,-26028.0140620753 + 1116.75797544357i,-27765.5595487443 + 23743.9678589742i,2605.05580348255 + 30818.5169402812i,31695.5833892636 + 24865.1181939014i,174.355951795357 - 557.666062357977i,-33403.4437615722 - 24468.4691545450i,738.505369598578 - 30286.7864503086i,31329.5228636260 - 25796.5765556941i,2535.32102156667 + 2648.91379620039i,-26189.8242804699 + 31247.0336349622i,-29558.6254879496 + 834.961411379725i,-26230.4291840715 - 33799.3141989620i,2592.74502693885 + 791.103418661886i,30936.3410361521 + 31222.3089673042i,1299.45182055866 + 2727.73774924522i,-33536.5299524089 - 25942.8543725586i,-92.4831585571802 - 30108.9185615024i,33802.7814108445 - 24431.7248190278i,-1498.81284989555 - 831.065949914725i,-30984.2737197205 + 26105.0813640825i,-2462.55603802906 + 27930.6473368462i,25486.9352722999 + 19099.2218824801i,30511.1590090003 + 26952.9546116042i,24982.4143774078 + 28496.7306650681i,-459.757645728080 - 4547.01144625849i,-24197.8917916935 - 28761.3863949940i,-30783.7481186923 - 3952.57004839177i,-26455.7209072801 + 27583.3271501804i,4148.98188220658 + 27645.7474506104i,28792.0438474286 + 19464.9904323802i,4224.00356664442 + 26714.3235456363i,-26415.1160036786 + 28467.6588030967i,-30916.1938085023 - 4323.33783400194i,-23845.3148678211 - 30813.6402600886i,-888.258406878143 + 160.328992927919i,24762.9236443721 + 30713.8311928866i,31206.4988805029 + 4147.72664609594i,23599.2279837547 - 28155.8185774296i,945.972743846440 - 26996.1201097002i,-25877.8522601991 - 19473.4110937533i,-28472.7996558173 - 27261.0114893202i,-18883.7235121325 - 28252.1604327491i,-26723.3539335779 + 4592.43364525470i,-28867.7862061866 + 28948.3380541758i,5004.12886663221 + 3590.58246374284i,29079.0904667220 - 26075.6648085321i,2948.86432900543 - 30877.3323867103i,-25891.0438862269 - 24302.7749511387i,-30513.1067397328 - 213.950729693108i,-25917.7089759734 + 24624.7633612922i,3086.21339688328 + 30833.4743939925i,29325.9944773315 + 25728.9517307206i,4505.10118427316 - 3039.99905859396i,-28507.5368087685 - 29391.8796135358i,-26895.7621546408 - 4449.53171677547i,-19754.4397686799 + 28929.7692083163i,-26942.8231142017 + 26137.1708566675i,-27809.7634588321 + 21257.8968486648i,3588.63473301034 + 24253.1001654769i,31183.2450467616 + 21204.1003190355i,-58.1164999940358 + 26157.1793632832i,-31623.6113699766 + 26895.3360012540i,-2880.69375336792 - 257.808722410947i,26671.2192776277 - 26598.0722587583i,29202.9083489088 - 26078.3554102384i,26811.6961043192 - 21820.2400914276i,-3073.11048104646 - 23481.4833734258i,-30260.2620917927 - 21508.2680711568i,-3157.89590953166 - 26581.8778558263i,26870.1216659530 - 26817.5629917940i,29105.4286194258 + 512.552833529498i,26662.3748459134 + 25122.1703889974i,-2770.70610860309 + 29372.2677297783i,-31769.8891868411 + 26658.0246101860i,88.5876970921806 - 3081.21682595744i,31351.9826917092 - 31615.9145651194i,3246.86713107798 + 178.984769366117i,-26712.3108074584 + 31637.5268525202i,-29504.7134195883 + 2746.39352568342i,-24600.7655915640 - 26236.6509031717i,-1092.67694093266 - 29656.0120245747i,27004.8035852993 - 26505.5909715232i,26880.8047009295 + 3083.16455668994i].';
%RC
PilotSequence = [24769.5252109022 + 24769.5252109022i,28486.1974405209 + 5371.10299855758i,24769.5252109022 - 24769.5252109022i,8.49741660046189 - 29807.8583973955i,-24769.5252109022 - 24769.5252109022i,-28449.2649458591 - 28968.3246728757i,-24769.5252109022 - 24769.5252109022i,-28980.8868710102 + 335.605039472830i,-24769.5252109022 + 24769.5252109022i,-796.556170140802 + 29706.0488013873i,24769.5252109022 + 24769.5252109022i,35501.0355563226 + 23498.6614511803i,24769.5252109022 + 24769.5252109022i,-5873.62770928885 + 23975.8165299544i,-24769.5252109022 + 24769.5252109022i,-4968.51796171097 + 30601.8273310245i,24769.5252109022 + 24769.5252109022i,30579.5783232012 - 5866.06831919623i,24769.5252109022 - 24769.5252109022i,23216.9040379714 + 980.826266348245i,24769.5252109022 + 24769.5252109022i,30287.0857177359 + 1165.80754605183i,24769.5252109022 - 24769.5252109022i,-5845.78119687954 - 6002.93435685044i,-24769.5252109022 + 24769.5252109022i,-47.0729903739931 + 29348.8875449107i,24769.5252109022 + 24769.5252109022i,6071.98659579057 + 29306.2594513876i,-24769.5252109022 + 24769.5252109022i,-29647.1983670815 + 561.706213216318i,-24769.5252109022 - 24769.5252109022i,-29082.3653988391 - 35685.3056525300i,-24769.5252109022 - 24769.5252109022i,310.088266102609 + 6239.97917318543i,24769.5252109022 + 24769.5252109022i,29813.2106662932 + 5762.50528801656i,24769.5252109022 - 24769.5252109022i,23517.0909131579 - 36691.8939279368i,24769.5252109022 - 24769.5252109022i,23583.2555018680 + 6813.91038546476i,24769.5252109022 + 24769.5252109022i,30159.5325053458 + 324.765622048863i,24769.5252109022 - 24769.5252109022i,702.410189392815 - 6148.64114106877i,-24769.5252109022 + 24769.5252109022i,-35608.6511072518 + 30510.2685867883i,-24769.5252109022 + 24769.5252109022i,6936.20329234025 + 24296.7442134809i,24769.5252109022 + 24769.5252109022i,172.057358928854 + 24380.3695831998i,-24769.5252109022 + 24769.5252109022i,-6121.62842999977 + 23712.5314949686i,24769.5252109022 + 24769.5252109022i,30522.6039419111 + 29935.1847667739i,24769.5252109022 + 24769.5252109022i,24208.0853812592 + 934.691302482095i,24769.5252109022 - 24769.5252109022i,24636.6408774995 - 34751.2213083765i,24769.5252109022 - 24769.5252109022i,24498.8368133374 + 1077.75567215872i,24769.5252109022 + 24769.5252109022i,24002.3755550000 + 29970.9217374550i,24769.5252109022 + 24769.5252109022i,30856.5720331643 + 23314.3913549729i,24769.5252109022 + 24769.5252109022i,-5110.99376573561 + 23855.5958646452i,-24769.5252109022 + 24769.5252109022i,-5941.51507870943 + 31036.8999656819i,24769.5252109022 + 24769.5252109022i,35662.2412360430 - 5267.53996737791i,24769.5252109022 - 24769.5252109022i,-854.192687789397 - 5860.80801368166i,-24769.5252109022 + 24769.5252109022i,-29966.9734428730 + 36804.8740095482i,-24769.5252109022 + 24769.5252109022i,-23672.3496274365 - 5915.21355113657i,-24769.5252109022 - 24769.5252109022i,-24742.1841868623 - 6229.95516442515i,-24769.5252109022 + 24769.5252109022i,-24862.4968155546 + 35790.9593179526i,-24769.5252109022 + 24769.5252109022i,-23790.8352502508 - 753.321118289096i,-24769.5252109022 - 24769.5252109022i,-29572.9900477944 - 30017.0567013212i,-24769.5252109022 - 24769.5252109022i,-219.130349302849 - 23754.6016773007i,24769.5252109022 - 24769.5252109022i,28971.4698205785 - 24677.6381536952i,24769.5252109022 - 24769.5252109022i,29511.5094607313 - 24678.2267193472i,24769.5252109022 - 24769.5252109022i,-5854.98979697615 - 24000.0335541765i,-24769.5252109022 - 24769.5252109022i,868.765818568113 - 30654.8105014871i,24769.5252109022 - 24769.5252109022i,283.995188864826 + 5033.73226212880i,-24769.5252109022 + 24769.5252109022i,-28.4350780612890 + 4942.77434532904i,24769.5252109022 - 24769.5252109022i,-210.032105265990 - 30875.0934585251i,-24769.5252109022 - 24769.5252109022i,-730.134083957962 - 23837.1847953442i,24769.5252109022 - 24769.5252109022i,5516.46645281225 - 23489.9555842448i,-24769.5252109022 - 24769.5252109022i,-30333.3249067696 - 29687.7419572539i,-24769.5252109022 - 24769.5252109022i,-22839.8173818184 - 168.219420406567i,-24769.5252109022 + 24769.5252109022i,-29674.4685756233 + 28748.2869515261i,-24769.5252109022 + 24769.5252109022i,-1261.43720271418 + 28683.6183005148i,24769.5252109022 + 24769.5252109022i,34817.9622009542 + 87.1322400618913i,24769.5252109022 - 24769.5252109022i,110.307012608607 - 28855.0870937916i,-24769.5252109022 - 24769.5252109022i,-35018.0745226274 - 29479.1322189802i,-24769.5252109022 - 24769.5252109022i,411.897862110755 + 5836.46837161540i,24769.5252109022 + 24769.5252109022i,35511.8749737465 - 891.020957283612i,24769.5252109022 - 24769.5252109022i,-7035.92838499763 - 307.169961411541i,-24769.5252109022 + 24769.5252109022i,904.275946237580 + 105.635272746014i,24769.5252109022 - 24769.5252109022i,1361.49336355080 + 397.220506164501i,-24769.5252109022 + 24769.5252109022i,-6075.49346613362 + 480.042729004076i,24769.5252109022 - 24769.5252109022i,29435.7929419609 - 6503.80985757773i,24769.5252109022 + 24769.5252109022i,30003.9059375347 + 36179.1061036491i,24769.5252109022 + 24769.5252109022i,-4959.43197945852 - 6412.85194077797i,-24769.5252109022 - 24769.5252109022i,-5016.17951773694 + 635.669296815155i,24769.5252109022 + 24769.5252109022i,29646.7446810581 + 115.567318123181i,24769.5252109022 - 24769.5252109022i,28987.9006116963 - 854.799646118003i,24769.5252109022 + 24769.5252109022i,637.753800165916 + 5580.19707731572i,-24769.5252109022 - 24769.5252109022i,-34542.6728790249 - 30226.1507800793i,-24769.5252109022 - 24769.5252109022i,1196.76855170287 - 23362.6108221898i,24769.5252109022 - 24769.5252109022i,29719.1995651738 - 30320.1741429831i,24769.5252109022 - 24769.5252109022i,22669.0597720377 + 6057.67096248459i,24769.5252109022 + 24769.5252109022i,29528.5165557166 - 205.360365403398i,24769.5252109022 - 24769.5252109022i,82.4605001992971 - 7106.40299093004i,-24769.5252109022 + 24769.5252109022i,-29436.1240101402 + 35695.2254361228i,-24769.5252109022 + 24769.5252109022i,-23024.4675933428 + 434.361451161328i,-24769.5252109022 - 24769.5252109022i,-30578.1559562089 - 35026.5719392279i,-24769.5252109022 - 24769.5252109022i,4868.79286905358 + 50.9109288962802i,24769.5252109022 + 24769.5252109022i,4913.52385860407 + 34688.6371607160i,-24769.5252109022 + 24769.5252109022i,-30768.8512274504 - 974.523709158290i,-24769.5252109022 - 24769.5252109022i,-23718.3803661351 - 28746.2024481753i,-24769.5252109022 - 24769.5252109022i,-23772.5284061173 - 28710.2999434045i,-24769.5252109022 - 24769.5252109022i,-30541.0150112121 - 908.947686100173i,-24769.5252109022 + 24769.5252109022i,5699.82917697289 + 34661.7470674911i,24769.5252109022 + 24769.5252109022i,-1048.73202844545 - 296.330543987573i,-24769.5252109022 - 24769.5252109022i,-722.347850853642 - 35400.9793954859i,24769.5252109022 - 24769.5252109022i,6595.59544482559 + 6951.94129263851i,-24769.5252109022 + 24769.5252109022i,-36139.9419642236 - 1036.72774150194i,-24769.5252109022 - 24769.5252109022i,6329.07329875392 - 1102.30376456006i,24769.5252109022 + 24769.5252109022i,-576.383569162571 + 6851.05133046158i,-24769.5252109022 - 24769.5252109022i,102.398161660125 - 35181.8490461831i,24769.5252109022 - 24769.5252109022i,584.182064051311 + 432.381172978103i,-24769.5252109022 + 24769.5252109022i,-6732.26529392914 + 29056.6217824572i,24769.5252109022 + 24769.5252109022i,35795.2815969594 + 29707.5570008705i,24769.5252109022 + 24769.5252109022i,45.6506233817076 - 5061.00247067055i,-24769.5252109022 - 24769.5252109022i,-36114.1983478417 - 5060.09509862375i,-24769.5252109022 + 24769.5252109022i,6201.52008636386 + 30090.1001510888i,24769.5252109022 + 24769.5252109022i,6312.41566462445 + 29706.9684352186i,-24769.5252109022 + 24769.5252109022i,-35958.5717800306 - 6339.32415052591i,-24769.5252109022 - 24769.5252109022i,-255.940226120437 + 40.0592496878966i,24769.5252109022 + 24769.5252109022i,34945.7422563559 + 6367.75922858720i,24769.5252109022 - 24769.5252109022i,-767.078840404131 - 29834.7484906203i,-24769.5252109022 - 24769.5252109022i,-29189.7541067566 - 30246.6463527311i,-24769.5252109022 - 24769.5252109022i,-29691.4756706086 + 5435.75938778448i,-24769.5252109022 + 24769.5252109022i,5453.45927358933 + 6010.00940645862i,24769.5252109022 - 24769.5252109022i,5618.27604882039 - 36006.2333360566i,-24769.5252109022 - 24769.5252109022i,-36753.9630806519 + 14.6773559462537i,-24769.5252109022 + 24769.5252109022i,5819.81073748592 + 35940.6573129985i,24769.5252109022 + 24769.5252109022i,5490.72283643033 - 6074.67805746993i,-24769.5252109022 - 24769.5252109022i,-30205.7716943795 - 5050.16305324658i,-24769.5252109022 + 24769.5252109022i,-29728.6166156055 + 30794.5948438324i,-24769.5252109022 + 24769.5252109022i,6386.50136606744 + 23052.1914879079i,24769.5252109022 + 24769.5252109022i,-395.013384969575 + 29349.2186130900i,-24769.5252109022 + 24769.5252109022i,-6823.22321072890 - 50.8986671118641i,24769.5252109022 - 24769.5252109022i,36618.8504781692 - 29450.1085752669i,24769.5252109022 - 24769.5252109022i,-5892.14300375739 - 22770.5382998666i,-24769.5252109022 - 24769.5252109022i,-5882.72595332571 - 29862.5950030296i,24769.5252109022 - 24769.5252109022i,36608.0110607452 - 789.542429454707i,24769.5252109022 + 24769.5252109022i,-6878.79361770335 + 35456.8808706396i,-24769.5252109022 + 24769.5252109022i,-221.202590869195 - 7041.74660170314i,24769.5252109022 - 24769.5252109022i,7034.17494982611 + 151.788629288791i,-24769.5252109022 + 24769.5252109022i,-35301.2543028285 + 6962.78071006248i,-24769.5252109022 - 24769.5252109022i,593.268046303753 - 36543.3424097339i,24769.5252109022 - 24769.5252109022i,28926.8614488722 + 5478.71854948681i,24769.5252109022 + 24769.5252109022i,28486.1974405209 + 5371.10299855758i,24769.5252109022 - 24769.5252109022i,8.49741660046189 - 29807.8583973955i,-24769.5252109022 - 24769.5252109022i,-28449.2649458591 - 28968.3246728757i,-24769.5252109022 - 24769.5252109022i,-28980.8868710102 + 335.605039472830i,-24769.5252109022 + 24769.5252109022i,-796.556170140802 + 29706.0488013873i,24769.5252109022 + 24769.5252109022i,35501.0355563226 + 23498.6614511803i,24769.5252109022 + 24769.5252109022i,-5873.62770928885 + 23975.8165299544i,-24769.5252109022 + 24769.5252109022i,-4968.51796171097 + 30601.8273310245i,24769.5252109022 + 24769.5252109022i,30579.5783232012 - 5866.06831919623i,24769.5252109022 - 24769.5252109022i,23216.9040379714 + 980.826266348245i,24769.5252109022 + 24769.5252109022i,30287.0857177359 + 1165.80754605183i,24769.5252109022 - 24769.5252109022i,-5845.78119687954 - 6002.93435685044i,-24769.5252109022 + 24769.5252109022i,-47.0729903739931 + 29348.8875449107i,24769.5252109022 + 24769.5252109022i,6071.98659579057 + 29306.2594513876i,-24769.5252109022 + 24769.5252109022i,-29647.1983670815 + 561.706213216318i,-24769.5252109022 - 24769.5252109022i,-29082.3653988391 - 35685.3056525300i,-24769.5252109022 - 24769.5252109022i,310.088266102609 + 6239.97917318543i,24769.5252109022 + 24769.5252109022i,29813.2106662932 + 5762.50528801656i,24769.5252109022 - 24769.5252109022i,23517.0909131579 - 36691.8939279368i,24769.5252109022 - 24769.5252109022i,23583.2555018680 + 6813.91038546476i,24769.5252109022 + 24769.5252109022i,30159.5325053458 + 324.765622048863i,24769.5252109022 - 24769.5252109022i,702.410189392815 - 6148.64114106877i,-24769.5252109022 + 24769.5252109022i,-35608.6511072518 + 30510.2685867883i,-24769.5252109022 + 24769.5252109022i,6936.20329234025 + 24296.7442134809i,24769.5252109022 + 24769.5252109022i,172.057358928854 + 24380.3695831998i,-24769.5252109022 + 24769.5252109022i,-6121.62842999977 + 23712.5314949686i,24769.5252109022 + 24769.5252109022i,30522.6039419111 + 29935.1847667739i,24769.5252109022 + 24769.5252109022i,24208.0853812592 + 934.691302482095i,24769.5252109022 - 24769.5252109022i,24636.6408774995 - 34751.2213083765i,24769.5252109022 - 24769.5252109022i,24498.8368133374 + 1077.75567215872i,24769.5252109022 + 24769.5252109022i,24002.3755550000 + 29970.9217374550i,24769.5252109022 + 24769.5252109022i,30856.5720331643 + 23314.3913549729i,24769.5252109022 + 24769.5252109022i,-5110.99376573561 + 23855.5958646452i,-24769.5252109022 + 24769.5252109022i,-5941.51507870943 + 31036.8999656819i,24769.5252109022 + 24769.5252109022i,35662.2412360430 - 5267.53996737791i,24769.5252109022 - 24769.5252109022i,-854.192687789397 - 5860.80801368166i,-24769.5252109022 + 24769.5252109022i,-29966.9734428730 + 36804.8740095482i,-24769.5252109022 + 24769.5252109022i,-23672.3496274365 - 5915.21355113657i,-24769.5252109022 - 24769.5252109022i,-24742.1841868623 - 6229.95516442515i,-24769.5252109022 + 24769.5252109022i,-24862.4968155546 + 35790.9593179526i,-24769.5252109022 + 24769.5252109022i,-23790.8352502508 - 753.321118289096i,-24769.5252109022 - 24769.5252109022i,-29572.9900477944 - 30017.0567013212i,-24769.5252109022 - 24769.5252109022i,-219.130349302849 - 23754.6016773007i,24769.5252109022 - 24769.5252109022i,28971.4698205785 - 24677.6381536952i,24769.5252109022 - 24769.5252109022i,29511.5094607313 - 24678.2267193472i,24769.5252109022 - 24769.5252109022i,-5854.98979697615 - 24000.0335541765i,-24769.5252109022 - 24769.5252109022i,868.765818568113 - 30654.8105014871i,24769.5252109022 - 24769.5252109022i,283.995188864826 + 5033.73226212880i,-24769.5252109022 + 24769.5252109022i,-28.4350780612890 + 4942.77434532904i,24769.5252109022 - 24769.5252109022i,-210.032105265990 - 30875.0934585251i,-24769.5252109022 - 24769.5252109022i,-730.134083957962 - 23837.1847953442i,24769.5252109022 - 24769.5252109022i,5516.46645281225 - 23489.9555842448i,-24769.5252109022 - 24769.5252109022i,-30333.3249067696 - 29687.7419572539i,-24769.5252109022 - 24769.5252109022i,-22839.8173818184 - 168.219420406567i,-24769.5252109022 + 24769.5252109022i,-29674.4685756233 + 28748.2869515261i,-24769.5252109022 + 24769.5252109022i,-1261.43720271418 + 28683.6183005148i,24769.5252109022 + 24769.5252109022i,34817.9622009542 + 87.1322400618913i,24769.5252109022 - 24769.5252109022i,110.307012608607 - 28855.0870937916i,-24769.5252109022 - 24769.5252109022i,-35018.0745226274 - 29479.1322189802i,-24769.5252109022 - 24769.5252109022i,411.897862110755 + 5836.46837161540i,24769.5252109022 + 24769.5252109022i,35511.8749737465 - 891.020957283612i,24769.5252109022 - 24769.5252109022i,-7035.92838499763 - 307.169961411541i,-24769.5252109022 + 24769.5252109022i,904.275946237580 + 105.635272746014i,24769.5252109022 - 24769.5252109022i,1361.49336355080 + 397.220506164501i,-24769.5252109022 + 24769.5252109022i,-6075.49346613362 + 480.042729004076i,24769.5252109022 - 24769.5252109022i,29435.7929419609 - 6503.80985757773i,24769.5252109022 + 24769.5252109022i,30003.9059375347 + 36179.1061036491i,24769.5252109022 + 24769.5252109022i,-4959.43197945852 - 6412.85194077797i,-24769.5252109022 - 24769.5252109022i,-5016.17951773694 + 635.669296815155i,24769.5252109022 + 24769.5252109022i,29646.7446810581 + 115.567318123181i,24769.5252109022 - 24769.5252109022i,28987.9006116963 - 854.799646118003i,24769.5252109022 + 24769.5252109022i,637.753800165916 + 5580.19707731572i,-24769.5252109022 - 24769.5252109022i,-34542.6728790249 - 30226.1507800793i,-24769.5252109022 - 24769.5252109022i,1196.76855170287 - 23362.6108221898i,24769.5252109022 - 24769.5252109022i,29719.1995651738 - 30320.1741429831i,24769.5252109022 - 24769.5252109022i,22669.0597720377 + 6057.67096248459i,24769.5252109022 + 24769.5252109022i,29528.5165557166 - 205.360365403398i,24769.5252109022 - 24769.5252109022i,82.4605001992971 - 7106.40299093004i,-24769.5252109022 + 24769.5252109022i,-29436.1240101402 + 35695.2254361228i,-24769.5252109022 + 24769.5252109022i,-23024.4675933428 + 434.361451161328i,-24769.5252109022 - 24769.5252109022i,-30578.1559562089 - 35026.5719392279i,-24769.5252109022 - 24769.5252109022i,4868.79286905358 + 50.9109288962802i,24769.5252109022 + 24769.5252109022i,4913.52385860407 + 34688.6371607160i,-24769.5252109022 + 24769.5252109022i,-30768.8512274504 - 974.523709158290i,-24769.5252109022 - 24769.5252109022i,-23718.3803661351 - 28746.2024481753i,-24769.5252109022 - 24769.5252109022i,-23772.5284061173 - 28710.2999434045i,-24769.5252109022 - 24769.5252109022i,-30541.0150112121 - 908.947686100173i,-24769.5252109022 + 24769.5252109022i,5699.82917697289 + 34661.7470674911i,24769.5252109022 + 24769.5252109022i,-1048.73202844545 - 296.330543987573i,-24769.5252109022 - 24769.5252109022i,-722.347850853642 - 35400.9793954859i,24769.5252109022 - 24769.5252109022i,6595.59544482559 + 6951.94129263851i,-24769.5252109022 + 24769.5252109022i,-36139.9419642236 - 1036.72774150194i,-24769.5252109022 - 24769.5252109022i,6329.07329875392 - 1102.30376456006i,24769.5252109022 + 24769.5252109022i,-576.383569162571 + 6851.05133046158i,-24769.5252109022 - 24769.5252109022i,102.398161660125 - 35181.8490461831i,24769.5252109022 - 24769.5252109022i,584.182064051311 + 432.381172978103i,-24769.5252109022 + 24769.5252109022i,-6732.26529392914 + 29056.6217824572i,24769.5252109022 + 24769.5252109022i,35795.2815969594 + 29707.5570008705i,24769.5252109022 + 24769.5252109022i,45.6506233817076 - 5061.00247067055i,-24769.5252109022 - 24769.5252109022i,-36114.1983478417 - 5060.09509862375i,-24769.5252109022 + 24769.5252109022i,6201.52008636386 + 30090.1001510888i,24769.5252109022 + 24769.5252109022i,6312.41566462445 + 29706.9684352186i,-24769.5252109022 + 24769.5252109022i,-35958.5717800306 - 6339.32415052591i,-24769.5252109022 - 24769.5252109022i,-255.940226120437 + 40.0592496878966i,24769.5252109022 + 24769.5252109022i,34945.7422563559 + 6367.75922858720i,24769.5252109022 - 24769.5252109022i,-767.078840404131 - 29834.7484906203i,-24769.5252109022 - 24769.5252109022i,-29189.7541067566 - 30246.6463527311i,-24769.5252109022 - 24769.5252109022i,-29691.4756706086 + 5435.75938778448i,-24769.5252109022 + 24769.5252109022i,5453.45927358933 + 6010.00940645862i,24769.5252109022 - 24769.5252109022i,5618.27604882039 - 36006.2333360566i,-24769.5252109022 - 24769.5252109022i,-36753.9630806519 + 14.6773559462537i,-24769.5252109022 + 24769.5252109022i,5819.81073748592 + 35940.6573129985i,24769.5252109022 + 24769.5252109022i,5490.72283643033 - 6074.67805746993i,-24769.5252109022 - 24769.5252109022i,-30205.7716943795 - 5050.16305324658i,-24769.5252109022 + 24769.5252109022i,-29728.6166156055 + 30794.5948438324i,-24769.5252109022 + 24769.5252109022i,6386.50136606744 + 23052.1914879079i,24769.5252109022 + 24769.5252109022i,-395.013384969575 + 29349.2186130900i,-24769.5252109022 + 24769.5252109022i,-6823.22321072890 - 50.8986671118641i,24769.5252109022 - 24769.5252109022i,36618.8504781692 - 29450.1085752669i,24769.5252109022 - 24769.5252109022i,-5892.14300375739 - 22770.5382998666i,-24769.5252109022 - 24769.5252109022i,-5882.72595332571 - 29862.5950030296i,24769.5252109022 - 24769.5252109022i,36608.0110607452 - 789.542429454707i,24769.5252109022 + 24769.5252109022i,-6878.79361770335 + 35456.8808706396i,-24769.5252109022 + 24769.5252109022i,-221.202590869195 - 7041.74660170314i,24769.5252109022 - 24769.5252109022i,7034.17494982611 + 151.788629288791i,-24769.5252109022 + 24769.5252109022i,-35301.2543028285 + 6962.78071006248i,-24769.5252109022 - 24769.5252109022i,593.268046303753 - 36543.3424097339i,24769.5252109022 - 24769.5252109022i,28926.8614488722 + 5478.71854948681i].';

OverSampling = 1;
PilotSequence = interp(PilotSequence, OverSampling);
PilotFPGAtmp = zeros(size(PilotFPGA,1)*OverSampling, size(PilotFPGA,2), size(PilotFPGA,3) );
for idx2 = 1:size(PilotFPGA,2)
    for idx3 = 1:size(PilotFPGA,3)
        PilotFPGAtmp(:,idx2,idx3) =  interp(PilotFPGA(:,idx2,idx3), OverSampling);
    end
end
PilotFPGA = PilotFPGAtmp;
circshiftFactor = -7*OverSampling;

NumTest = 10;
NumChannel = 4;
figure(1101);clf
DiagonalLoadSNR = 20;%(10:-2:-30).';
weightMagToltleAvergeVector = zeros(size(DiagonalLoadSNR));
weightMagMinAvergeVector = zeros(size(DiagonalLoadSNR));

for idxDiagonalLoadSNR = 1:length(DiagonalLoadSNR)
    weightMagToltleSum = 0;
    weightMagMinSum = 0;
    fprintf('DiagonalLoadSNR = %d:\n', DiagonalLoadSNR(idxDiagonalLoadSNR));
    for idxLoop = 1:NumTest
        fprintf('idxLoop = %d:\n', idxLoop);
        waveformRxRec = zeros(length(PilotSequence), NumChannel);
        maxXcorrRec = zeros(1, NumChannel);
        close(1101);
        figure(1101);clf
        fprintf('\tMax lag = ');
        for idxCh = 1:NumChannel
            waveformRx = PilotFPGA(:,idxCh,idxLoop);
            waveformRef = circshift(PilotSequence, circshiftFactor);
            %         waveformRx = downsample(waveformRx, 2, 1);
            %         waveformRef = downsample(waveformRef, 2, 0);
            waveformRxRec(:,idxCh) = waveformRx;
            
            xcorrRef = xcorr(waveformRx, waveformRef,'coeff');
            
            [maxXcorrRec(idxCh), idxMax] = max(xcorrRef);
            
            hold on;
            plot(1 - length(waveformRef):length(waveformRef) - 1, abs(xcorrRef), '.-');
            grid on;
            title('xcorrRef')
            xlabel('Sample');
            ylabel('Coeff');
            
            fprintf(' %d ;', idxMax-length(waveformRef));
            idxShift = idxMax-length(waveformRef);
            waveformRxRec(:,idxCh) = circshift(waveformRxRec(:,idxCh), -idxShift);
            
            %         ChannelRelativePhase = rad2deg(phase(PilotFPGA(:,1,idxLoop)'.'.*PilotFPGA(:,idxCh,idxLoop))) %#ok<NASGU,NOPTS>
            
        end
        fprintf('\n');

        % check 
        fprintf('\tMax lag after sync = ');
        for idxCh = 1:NumChannel
            
            xcorrRef = xcorr(waveformRxRec(:,idxCh), waveformRef,'coeff');
            
            [maxXcorrRec(idxCh), idxMax] = max(xcorrRef);
            
            
            fprintf(' %d ;', idxMax-length(waveformRef));

            
            %         ChannelRelativePhase = rad2deg(phase(PilotFPGA(:,1,idxLoop)'.'.*PilotFPGA(:,idxCh,idxLoop))) %#ok<NASGU,NOPTS>
            
        end
        
        %     waveformRxRec(:, 1) = circshift(waveformRxRec(:, 1), 1);
        
        maxXcorrRec = maxXcorrRec./maxXcorrRec(1);
        %     SyncChannelPhaseOffset = rad2deg(phase(maxXcorrRec)) %#ok<NOPTS>
        
        %     ChannelRelativePhase = rad2deg(phase(PilotFPGA(:,1,idxLoop)'*PilotFPGA(:,:,idxLoop))) %#ok<NOPTS>
        
        currentDir = cd('..');
        sysPara = GenSysPara();                         %% Gen. System para.
        %     ShowConfiguration(sysPara);                     %% print simulation configuration.
        hAntennaElement = GenAntennaElement(sysPara);   %% Gen. antenna element
        hArray = GenArray(sysPara, hAntennaElement);    %% Gen. array
        sysPara.WeightsNormalization = 'preserve power';
        sysPara.MmsePara.DiagonalLoadingSNR = DiagonalLoadSNR(idxDiagonalLoadSNR);
        [weight, errVector] = GenWeight(sysPara, hArray, waveformRxRec, waveformRef);             %% Gen. Beamforming weight
        weight = weight/max(abs(weight));
        WeightMagnitude = abs(weight).';
        fprintf('\tWeightMagnitude ;');
        for idx = 1:NumChannel
            fprintf(' %.4f;', WeightMagnitude(idx));
        end
        fprintf(' Min: %.4f;', min(WeightMagnitude));
        fprintf('\n');
        weightMagToltleSum = weightMagToltleSum + sum(WeightMagnitude);
        weightMagMinSum = weightMagMinSum + min(WeightMagnitude);
        WeightPhase = rad2deg(phase(weight*weight(1)')).';
        fprintf('\tWeightPhase ;');
        for idx = 1:NumChannel
            fprintf(' %.4f;', WeightPhase(idx));
        end
        fprintf('\n');
        ViewArrayPattern(hArray, 5725e6 , 0, 0, weight, 1200+100);
        cd(currentDir)
    end
    fprintf('\n');
    weightMagToltleAverge = weightMagToltleSum/(NumTest*NumChannel);
    weightMagMinAverge = weightMagMinSum/(NumTest);
    weightMagToltleAvergeVector(idxDiagonalLoadSNR) = weightMagToltleAverge;
    weightMagMinAvergeVector(idxDiagonalLoadSNR) = weightMagMinAverge;
    fprintf('Average of totle weight: %.4f\n', weightMagToltleAverge);
    fprintf('Average of min   weight: %.4f\n', weightMagMinAverge);
    fprintf('\n');
end
figure(2001);
plot(DiagonalLoadSNR,weightMagToltleAvergeVector,'o-');
hold on;
plot(DiagonalLoadSNR,weightMagMinAvergeVector,'s-');
grid on;
legend('Totle Average', 'Minimum Average');
title('Weight Magnitude Average - Diagonal Loading SNR Threshold');
xlabel('Diagonal Loading SNR Threshold /dB');
ylabel('Weight Magnitude  Average');
